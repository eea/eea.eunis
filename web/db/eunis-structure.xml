<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!--
     You can run this change log on your database as many times as you want, it will ignore the
     changes that are already applied. It also means that you can't modify an existing revision.
     Always add to the end.

     Use the maven goals: liquibase:update, liquibase:status or liquibase:changelogSync
      Potentially with -Dliquibase.dropFirst=true
      To roll back do: -Dliquibase.rollbackCount=2 liquibase:rollback

 -->
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

    <property name="id_site.type" value="varchar(16)"/>
    <property name="id_habitat.type" value="int(16)"/>
    <property name="id_nature_object.type" value="int(11)"/>
    <property name="id_dc.type" value="int(11)"/>
    <property name="text" value=" text" dbms="mysql"/>

    <changeSet author="roug" id="rev-1">
        <sql>CREATE TABLE chm62edt_abundance (
  ID_ABUNDANCE int(11) NOT NULL default '0',
  CODE varchar(2) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_ABUNDANCE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-2">
        <sql>CREATE TABLE chm62edt_activity_influence (
  ID_ACTIVITY_INFLUENCE varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_ACTIVITY_INFLUENCE),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-3">
        <sql>CREATE TABLE chm62edt_activity_intensity (
  ID_ACTIVITY_INTENSITY varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_ACTIVITY_INTENSITY),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-4">
        <sql>CREATE TABLE chm62edt_altitude (
  ID_ALTITUDE int(11) NOT NULL default '0',
  NAME varchar(64) NOT NULL default '''''',
  DESCRIPTION text,
  OLD_CODE varchar(2) default NULL,
  PRIMARY KEY  (ID_ALTITUDE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-5">
        <sql>CREATE TABLE chm62edt_area_legal_text (
  ID_GEOSCOPE int(11) NOT NULL default '-1',
  ID_DC int(11) NOT NULL default '-1',
  LEGAL_DATE date NOT NULL default '0000-00-00',
  ID_LEGAL_AREA_EVENT int(11) NOT NULL default '0',
  DESCRIPTION text,
  INPUT_DATE date default NULL,
  PRIMARY KEY  (ID_GEOSCOPE,ID_DC,ID_LEGAL_AREA_EVENT,LEGAL_DATE),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_LEGAL_AREA_EVENT (ID_LEGAL_AREA_EVENT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-6">
        <sql>CREATE TABLE chm62edt_biogeoregion (
  ID_BIOGEOREGION int(11) NOT NULL default '-1',
  ID_GEOSCOPE int(11) NOT NULL default '-1',
  CODE varchar(2) NOT NULL default '''''',
  CODE_EEA varchar(5) default NULL,
  NAME varchar(128) NOT NULL default '''''',
  SELECTION int(11) default NULL,
  PRIMARY KEY  (ID_BIOGEOREGION,ID_GEOSCOPE),
  KEY IDX_CODE (CODE),
  KEY IDX_NAME (NAME),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_ID_BIOGEOREGION (ID_BIOGEOREGION)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-7">
        <sql>CREATE TABLE chm62edt_chemistry (
  ID_CHEMISTRY int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_CHEMISTRY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-8">
        <sql>CREATE TABLE chm62edt_class_code (
  ID_CLASS_CODE int(11) NOT NULL default '0',
  NAME varchar(255) NOT NULL default '''''',
  SORT_ORDER smallint(6) default NULL,
  UNVALIDATED_CODE char(1) default NULL,
  CURRENT_DATA int(11) default NULL,
  LEGAL int(11) default NULL,
  ID_DC int(11) default NULL,
  CURRENT_CLASSIFICATION tinyint(4) default NULL,
  PRIMARY KEY  (ID_CLASS_CODE),
  KEY IDX_SORT_ORDER (SORT_ORDER),
  KEY IDX_LEGAL (LEGAL),
  KEY IDX_NAME (NAME),
  KEY IDX_CURRENT_CLASSIFICATION (CURRENT_CLASSIFICATION),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-9">
        <sql>CREATE TABLE chm62edt_climate (
  ID_CLIMATE int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_CLIMATE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-10">
        <sql>CREATE TABLE chm62edt_conservation_status (
  ID_CONSERVATION_STATUS int(11) NOT NULL default '0',
  CODE varchar(10) default NULL,
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  RED_BOOK_DATE date default NULL,
  ID_CONSERVATION_STATUS_LINK int(11) default NULL,
  ID_DC int(11) NOT NULL default '-1',
  PRIMARY KEY  (ID_CONSERVATION_STATUS),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_CONSERVATION_STATUS_LINK (ID_CONSERVATION_STATUS_LINK),
  KEY IDX_CODE (CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-11">
        <sql>CREATE TABLE chm62edt_country (
  ID_COUNTRY int(11) NOT NULL default '-1',
  ID_GEOSCOPE int(11) NOT NULL default '-1',
  EUNIS_AREA_CODE varchar(3) NOT NULL default '''''',
  AREA_NAME varchar(255) default NULL,
  AREA_NAME_EN varchar(255) default NULL,
  AREA_NAME_FR varchar(255) default NULL,
  ISO_2L varchar(2) default NULL,
  ISO_3L varchar(3) default NULL,
  ISO_N smallint(6) default NULL,
  ISO_2_WCMC varchar(2) default NULL,
  ISO_3_WCMC varchar(3) default NULL,
  ISO_3_WCMC_PARENT varchar(3) default NULL,
  TEL_CODE smallint(6) default NULL,
  AREUCD varchar(2) default NULL,
  SORT_NUMBER int(11) default NULL,
  COUNTRY_TYPE char(1) default NULL,
  SURFACE int(11) default NULL,
  NGO int(11) default NULL,
  NUMBER_DESIGN_AREA int(11) default NULL,
  SOURCE varchar(255) default NULL,
  POLITICAL_STATUS varchar(100) default NULL,
  POPULATION int(11) default NULL,
  POP_DENSITY double default NULL,
  CAPITAL varchar(64) default NULL,
  CURRENCY_CODE varchar(3) default NULL,
  CURRENCY_NAME varchar(64) default NULL,
  LAT_MIN varchar(16) default NULL,
  LAT_MAX varchar(16) default NULL,
  LONG_MIN varchar(16) default NULL,
  LONG_MAX varchar(16) default NULL,
  ALT_MIN int(11) default NULL,
  ALT_MAX int(11) default NULL,
  SELECTION int(11) default NULL,
  PRIMARY KEY  (ID_COUNTRY,ID_GEOSCOPE),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_AREA_NAME_EN (AREA_NAME_EN),
  KEY IDX_EUNIS_AREA_CODE (EUNIS_AREA_CODE),
  KEY IDX_ISO_2L (ISO_2L,ISO_3L),
  KEY IDX_SELECTION (SELECTION),
  KEY IDX_ISO_3L (ISO_3L)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-12">
        <sql>CREATE TABLE chm62edt_country_biogeoregion (
  CODE_BIOGEOREGION varchar(16) NOT NULL default '''''',
  CODE_COUNTRY varchar(16) NOT NULL default '''''',
  PERCENT int(11) default NULL,
  PRIMARY KEY  (CODE_BIOGEOREGION,CODE_COUNTRY),
  KEY IDX_CODE_COUNTRY (CODE_COUNTRY),
  KEY IDX_CODE_BIOGEOREGION (CODE_BIOGEOREGION)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-13">
        <sql>CREATE TABLE chm62edt_country_sites_factsheet (
  SOURCE_DB varchar(50) NOT NULL default '''''',
  AREA_NAME_EN varchar(254) NOT NULL default '''''',
  NUMBER_OF_SITES varchar(255) default NULL,
  NUMBER_OF_SPECIES varchar(255) default '0',
  NUMBER_OF_HABITATS varchar(255) default '0',
  NO_SITES_PER_SQUARE_KM varchar(255) default NULL,
  PROCENT_NO_SITES_WITH_SURFACE_AVAILABLE varchar(255) default NULL,
  TOTAL_SIZE varchar(255) default NULL,
  AVG_SIZE varchar(255) default NULL,
  NO_OF_PRIORITY_SITES varchar(255) default NULL,
  TOTAL_SIZE_FOR_PRIORITY_SITES varchar(255) default NULL,
  STANDARD_DEVIATION varchar(255) default NULL,
  PRIMARY KEY  (SOURCE_DB,AREA_NAME_EN),
  KEY IDX_SOURCE_DB (SOURCE_DB),
  KEY IDX_AREA_NAME_EN (AREA_NAME_EN)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-14">
        <sql>CREATE TABLE chm62edt_cover (
  ID_COVER int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_COVER)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-15">
        <sql>CREATE TABLE chm62edt_depth (
  ID_DEPTH int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_DEPTH)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-16">
        <sql>CREATE TABLE chm62edt_designations (
  ID_DESIGNATION varchar(16) NOT NULL default '0',
  ID_GEOSCOPE int(11) NOT NULL default '0',
  ID_DC int(11) default NULL,
  DESCRIPTION varchar(255) NOT NULL default '''''',
  DESCRIPTION_EN varchar(255) default NULL,
  DESCRIPTION_FR varchar(255) default NULL,
  ORIGINAL_DATASOURCE varchar(255) default NULL,
  CDDA_SITES char(1) default 'N',
  TOTAL_AREA varchar(50) default NULL,
  REFERENCE_AREA varchar(50) default NULL,
  NATIONAL_LAW text,
  NATIONAL_CATEGORY varchar(8) default NULL,
  NATIONAL_LAW_REFERENCE text,
  NATIONAL_LAW_AGENCY text,
  DATA_SOURCE varchar(255) default NULL,
  TOTAL_NUMBER int(11) default '0',
  REFERENCE_NUMBER varchar(50) default NULL,
  REFERENCE_DATE varchar(16) default NULL,
  REMARK text,
  REMARK_SOURCE varchar(255) default NULL,
  SOURCE_DB varchar(32) NOT NULL default '''',
  PRIMARY KEY  (ID_DESIGNATION,ID_GEOSCOPE),
  KEY IDX_ID_DESIGNATION (ID_DESIGNATION),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_NATIONAL_CATEGORY (NATIONAL_CATEGORY),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_DESCRIPTION (DESCRIPTION),
  KEY IDX_DESCRIPTION_EN (DESCRIPTION_EN),
  KEY IDX_DESCRIPTION_FR (DESCRIPTION_FR)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-17">
        <sql>CREATE TABLE chm62edt_distribution_status (
  ID_DISTRIBUTION_STATUS int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  ID_DC int(11) NOT NULL default '-1',
  PRIMARY KEY  (ID_DISTRIBUTION_STATUS),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-18">
        <sql>CREATE TABLE chm62edt_exposure (
  ID_EXPOSURE int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_EXPOSURE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-19">
        <sql>CREATE TABLE chm62edt_faithfulness (
  ID_FAITHFULNESS int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(100) default NULL,
  PRIMARY KEY  (ID_FAITHFULNESS)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-20">
        <sql>CREATE TABLE chm62edt_frequencies (
  ID_FREQUENCIES int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_FREQUENCIES)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-21">
        <sql>CREATE TABLE chm62edt_geomorph (
  ID_GEOMORPH int(11) NOT NULL default '0',
  NAME varchar(64) NOT NULL default '''''',
  DESCRIPTION text,
  OLD_CODE varchar(16) default NULL,
  PRIMARY KEY  (ID_GEOMORPH)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-22">
        <sql>CREATE TABLE chm62edt_geoscope (
  ID_GEOSCOPE int(11) NOT NULL default '0',
  ID_GEOSCOPE_PARENT int(11) NOT NULL default '-1',
  ID_DC int(11) default '-1',
  AREA_TYPE varchar(10) NOT NULL default '''''',
  PRIMARY KEY  (ID_GEOSCOPE,ID_GEOSCOPE_PARENT),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_GEOSCOPE_PARENT_GEOSCOPE (ID_GEOSCOPE_PARENT,ID_GEOSCOPE),
  KEY IDX_ID_GEOSCOPE_PARENT (ID_GEOSCOPE_PARENT),
  KEY IDX_AREA_TYPE (AREA_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-23">
        <sql>CREATE TABLE chm62edt_global (
  ID_GLOBAL varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_GLOBAL),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-24">
        <sql>CREATE TABLE chm62edt_glossary (
  TERM varchar(64) NOT NULL default '''''',
  ID_LANGUAGE int(11) NOT NULL default '25',
  SOURCE varchar(255) NOT NULL default '''''',
  DEFINITION text NOT NULL,
  LINK_DESCRIPTION varchar(255) default NULL,
  LINK_URL varchar(255) default NULL,
  REFERENCE varchar(255) default NULL,
  DATE_CHANGED varchar(100) default NULL,
  CURRENT tinyint(4) default NULL,
  ID_DC int(11) default NULL,
  TERM_DOMAIN varchar(255) default NULL,
  SEARCH_DOMAIN varchar(255) default NULL,
  PRIMARY KEY  (TERM,ID_LANGUAGE,SOURCE),
  KEY IDX_TERM (TERM),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_DEFINITION (DEFINITION(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-25">
        <sql>CREATE TABLE chm62edt_grid (
  NAME char(16) NOT NULL default '''''',
  LATITUDE char(32) NOT NULL default '''''',
  LONGITUDE char(32) NOT NULL default '''''',
  ID_DC int(11) NOT NULL default '-1',
  PROSPECT int(11) default NULL,
  PRIMARY KEY  (NAME,LATITUDE,LONGITUDE,ID_DC),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-26">
        <sql>CREATE TABLE chm62edt_group_species (
  ID_GROUP_SPECIES int(11) NOT NULL default '0',
  COMMON_NAME varchar(50) NOT NULL default '''''',
  SCIENTIFIC_NAME varchar(50) NOT NULL default '''''',
  SELECTION int(11) default NULL,
  ID_DC int(11) default '-1',
  PRIMARY KEY  (ID_GROUP_SPECIES),
  KEY IDX_SCIENTIFIC_NAME (SCIENTIFIC_NAME),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_COMMON_NAME (COMMON_NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-27">
        <sql>CREATE TABLE chm62edt_habitat (
  ID_HABITAT int(16) NOT NULL default '0',
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  SCIENTIFIC_NAME varchar(255) default NULL,
  DESCRIPTION text,
  CODE_2000 varchar(4) default NULL,
  CODE_ANNEX1 varchar(25) default NULL,
  PRIORITY int(11) default NULL,
  EUNIS_HABITAT_CODE varchar(16) NOT NULL default '',
  CLASS_REF varchar(16) default NULL,
  CODE_PART_2 varchar(64) default NULL,
  LEVEL int(11) default NULL,
  ORIGINALLY_PUBLISHED_CODE varchar(25) default NULL,
  PRIMARY KEY  (ID_HABITAT),
  UNIQUE KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_SCIENTIFIC_NAME (SCIENTIFIC_NAME),
  KEY IDX_CODE_ANNEX1 (CODE_ANNEX1),
  KEY IDX_EUNIS_HABITAT_CODE (EUNIS_HABITAT_CODE),
  KEY IDX_LEVEL (LEVEL),
  KEY IDX_DESCRIPTION (DESCRIPTION(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-28">
        <sql>CREATE TABLE chm62edt_habitat_change (
  ID_HABITAT_CHANGE int(16) NOT NULL default '-1',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_HABITAT_CHANGE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-29">
        <sql>CREATE TABLE chm62edt_habitat_class_code (
  ID_HABITAT int(16) NOT NULL default '-1',
  ID_CLASS_CODE int(11) NOT NULL default '-1',
  TITLE varchar(255) NOT NULL default '''''',
  RELATION_TYPE char(1) NOT NULL default '''',
  CODE varchar(30) NOT NULL default '''''',
  PRIMARY KEY  (ID_HABITAT,ID_CLASS_CODE,TITLE,RELATION_TYPE,CODE),
  KEY IDX_ID_HABITAT (ID_HABITAT),
  KEY IDX_ID_CLASS_CODE (ID_CLASS_CODE),
  KEY IDX_CODE (CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-30">
        <sql>CREATE TABLE chm62edt_habitat_description (
  ID_HABITAT int(16) NOT NULL default '-1',
  ID_LANGUAGE int(11) NOT NULL default '0',
  DESCRIPTION text NOT NULL,
  OWNER_TEXT text,
  ID_DC int(11) default NULL,
  PRIMARY KEY  (ID_HABITAT,ID_LANGUAGE,DESCRIPTION(255)),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-31">
        <sql>CREATE TABLE chm62edt_habitat_habitat (
  ID_HABITAT int(16) NOT NULL default '-1',
  ID_HABITAT_LINK int(16) NOT NULL default '-1',
  RELATION_TYPE char(1) NOT NULL default '''',
  PRIMARY KEY  (ID_HABITAT,ID_HABITAT_LINK,RELATION_TYPE),
  KEY IDX_ID_HABITAT_LINK (ID_HABITAT,ID_HABITAT_LINK),
  KEY IDX_ID_HABITAT_LINK_ID_HABITAT (ID_HABITAT_LINK,ID_HABITAT),
  KEY IDX_ID_HABITAT (ID_HABITAT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-32">
        <sql>CREATE TABLE chm62edt_habitat_international_name (
  ID_HABITAT int(11) NOT NULL default '0',
  ID_LANGUAGE int(11) NOT NULL default '0',
  INTERNATIONAL_NAME varchar(255) NOT NULL default '''''',
  PRIMARY KEY  (ID_HABITAT,ID_LANGUAGE),
  KEY IDX_ID_HABITAT (ID_HABITAT),
  KEY IDX_ID_LANGUAGE (ID_LANGUAGE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-33">
        <sql>CREATE TABLE chm62edt_habitat_key_navigation (
  ID_PAGE int(11) default NULL,
  PAGE_LEVEL int(11) default NULL,
  PAGE_NAME varchar(255) default NULL,
  PAGE_NOTES text,
  ID_QUESTION varchar(10) default NULL,
  QUESTION_CODE varchar(10) default NULL,
  QUESTION_LABEL varchar(255) default NULL,
  QUESTION_EXPLANATION text,
  POSSIBLE_ANSWERS int(11) default NULL,
  ID_ANSWER int(11) default NULL,
  ANSWER_LABEL varchar(100) default NULL,
  ID_QUESTION_LINK varchar(50) default NULL,
  ID_HABITAT_LINK int(16) default NULL,
  ADDITIONAL_INFO varchar(100) default NULL,
  PAGE_CODE varchar(10) default NULL,
  KEY IDX_HABITAT_KEY_NAVIGATION (ID_PAGE,PAGE_LEVEL,PAGE_NAME,ID_QUESTION,ID_ANSWER,ID_QUESTION_LINK,ID_HABITAT_LINK),
  KEY IDX_PAGE_LEVEL (PAGE_LEVEL),
  KEY IDX_PAGE_CODE (PAGE_CODE),
  KEY IDX_QUESTION_CODE (QUESTION_CODE),
  KEY IDX_ID_ANSWER (ID_ANSWER)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-34">
        <sql>CREATE TABLE chm62edt_habitat_references (
  ID_HABITAT int(16) NOT NULL default '-1',
  ID_DC int(11) NOT NULL default '-1',
  HAVE_SOURCE int(11) NOT NULL default '0',
  HAVE_OTHER_REFERENCES int(11) NOT NULL default '0',
  PRIMARY KEY  (ID_HABITAT,ID_DC),
  KEY IDX_ID_HABITAT (ID_HABITAT),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-35">
        <sql>CREATE TABLE chm62edt_habitat_syntaxa (
  ID_HABITAT int(16) NOT NULL default '-1',
  ID_SYNTAXA int(11) NOT NULL default '-1',
  RELATION_TYPE char(1) default NULL,
  ID_SYNTAXA_SOURCE char(1) default NULL,
  PRIMARY KEY  (ID_HABITAT,ID_SYNTAXA),
  KEY IDX_RELATION_TYPE (RELATION_TYPE),
  KEY IDX_ID_SYNTAXA_SOURCE (ID_SYNTAXA_SOURCE),
  KEY IDX_ID_HABITAT (ID_HABITAT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-36">
        <sql>CREATE TABLE chm62edt_human_activity (
  ID_HUMAN_ACTIVITY int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_HUMAN_ACTIVITY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-37">
        <sql>CREATE TABLE chm62edt_humidity (
  ID_HUMIDITY int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_HUMIDITY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-38">
        <sql>CREATE TABLE chm62edt_impact (
  ID_IMPACT int(11) NOT NULL default '0',
  NAME varchar(255) default NULL,
  DESCRIPTION text,
  NATURA2000_CODE varchar(16) default NULL,
  NATURA2000_NAME varchar(255) default NULL,
  PRIMARY KEY  (ID_IMPACT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-39">
        <sql>CREATE TABLE chm62edt_info_quality (
  ID_INFO_QUALITY int(11) NOT NULL default '0',
  STATUS varchar(50) NOT NULL default '''''',
  DESCRIPTION varchar(255) NOT NULL default '''''',
  PRIMARY KEY  (ID_INFO_QUALITY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-40">
        <sql>CREATE TABLE chm62edt_isolation (
  ID_ISOLATION varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_ISOLATION),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-41">
        <sql>CREATE TABLE chm62edt_language (
  ID_LANGUAGE int(11) NOT NULL default '0',
  CODE varchar(2) NOT NULL default '''''',
  NAME_EN varchar(255) NOT NULL default '''''',
  SELECTION int(11) default NULL,
  NAME_FR varchar(255) default NULL,
  NAME_DE varchar(255) default NULL,
  FAMILY varchar(255) default NULL,
  COMMENT varchar(255) default NULL,
  PRIMARY KEY  (ID_LANGUAGE),
  KEY IDX_CODE (CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-42">
        <sql>CREATE TABLE chm62edt_legal_area_event (
  ID_LEGAL_AREA_EVENT int(11) NOT NULL default '0',
  NAME varchar(128) NOT NULL default '''''',
  DESCRIPTION text,
  PRIMARY KEY  (ID_LEGAL_AREA_EVENT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-43">
        <sql>CREATE TABLE chm62edt_legal_status (
  ID_LEGAL_STATUS int(11) NOT NULL default '0',
  ANNEX varchar(50) NOT NULL default '''''',
  PRIORITY int(11) default NULL,
  COMMENT text,
  CODE varchar(8) default NULL,
  PRIMARY KEY  (ID_LEGAL_STATUS)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-44">
        <sql>CREATE TABLE chm62edt_life_form (
  ID_LIFE_FORM int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  DATE_ADDED date default NULL,
  PRIMARY KEY  (ID_LIFE_FORM)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-45">
        <sql>CREATE TABLE chm62edt_light_intensity (
  ID_LIGHT_INTENSITY int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_LIGHT_INTENSITY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-46">
        <sql>CREATE TABLE chm62edt_motivation (
  ID_MOTIVATION int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_MOTIVATION)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-47">
        <sql>CREATE TABLE chm62edt_natura2000_activity_code (
  ID_ACTIVITY_CODE varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_ACTIVITY_CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-48">
        <sql>CREATE TABLE chm62edt_natura2000_conservation_code (
  ID_CONSERVATION_CODE varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_CONSERVATION_CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-49">
        <sql>CREATE TABLE chm62edt_natura2000_motivation_code (
  ID_MOTIVATION_CODE varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_MOTIVATION_CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-50">
        <sql>CREATE TABLE chm62edt_natura2000_site_type (
  ID_SITE_TYPE varchar(8) NOT NULL default '0',
  NAME varchar(255) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_SITE_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-51">
        <sql>CREATE TABLE chm62edt_nature_object (
  ID_NATURE_OBJECT int(11) NOT NULL default '0',
  ID_DC int(11) NOT NULL default '-1',
  ORIGINAL_CODE varchar(16) default NULL,
  TYPE varchar(32) NOT NULL default '''''',
  PRIMARY KEY  (ID_NATURE_OBJECT),
  UNIQUE KEY ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_TYPE (TYPE),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ORIGINAL_CODE (ORIGINAL_CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-52">
        <sql>CREATE TABLE chm62edt_nature_object_attributes (
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  NAME varchar(50) NOT NULL default '',
  OBJECT varchar(255) NOT NULL default '',
  OBJECTLANG varchar(10) NOT NULL default '',
  TYPE enum('reference','','string','integer','decimal','boolean','dateTime','date') default '',
  PRIMARY KEY  (ID_NATURE_OBJECT,NAME,OBJECT,OBJECTLANG),
  KEY ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY PREDICATE (NAME),
  KEY OBJECT (OBJECT),
  CONSTRAINT chm62edt_nature_object_attributes_ibfk_1 FOREIGN KEY (ID_NATURE_OBJECT) REFERENCES chm62edt_nature_object (ID_NATURE_OBJECT) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-53">
        <sql>CREATE TABLE chm62edt_nature_object_geoscope (
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_LINK int(11) NOT NULL default '-1',
  ID_DC int(11) NOT NULL default '-1',
  ID_GEOSCOPE int(11) NOT NULL default '-1',
  ID_REPORT_ATTRIBUTES int(11) NOT NULL default '-1',
  PRIMARY KEY  (ID_NATURE_OBJECT,ID_NATURE_OBJECT_LINK,ID_DC,ID_GEOSCOPE,ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_NATURE_OBJECT_LINK (ID_NATURE_OBJECT_LINK),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_ID_REPORT_ATTRIBUTES (ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_NATURE_OBJECT_LINK_NATUR (ID_NATURE_OBJECT_LINK,ID_NATURE_OBJECT),
  KEY IDX_ID_NATURE_OBJECT_GEOSCOPE (ID_NATURE_OBJECT,ID_GEOSCOPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-54">
        <sql>CREATE TABLE chm62edt_nature_object_links (
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  LINK varchar(1024) default NULL,
  LINKTEXT varchar(64) default NULL,
  KEY ID_NATURE_OBJECT (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-55">
        <sql>CREATE TABLE chm62edt_nature_object_picture (
  ID_OBJECT varchar(16) NOT NULL default '-1',
  NATURE_OBJECT_TYPE varchar(16) NOT NULL default '''''',
  NAME varchar(128) NOT NULL default '''''',
  FILE_NAME varchar(255) NOT NULL default '''''',
  DESCRIPTION varchar(255) default NULL,
  MAIN_PIC tinyint(1) NOT NULL default '0',
  MAX_WIDTH int(10) unsigned default '0',
  MAX_HEIGHT int(10) unsigned default '0',
  SOURCE varchar(255) default '',
  SOURCE_URL varchar(1024) default NULL,
  LICENSE enum('','CC BY','CC BY-SA','CC BY-ND','CC BY-NC','CC BY-NC-SA','CC BY-NC-ND','Copyrighted','Public domain') default '',
  KEY ID_OBJECT (ID_OBJECT),
  KEY MAIN_PIC (MAIN_PIC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-56">
        <sql>CREATE TABLE chm62edt_nature_object_report_type (
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_LINK int(11) NOT NULL default '-1',
  ID_GEOSCOPE int(11) default NULL,
  ID_REPORT_TYPE int(11) NOT NULL default '-1',
  ID_REPORT_ATTRIBUTES int(11) NOT NULL default '-1',
  ID_DC int(11) NOT NULL default '-1',
  PRIMARY KEY  (ID_NATURE_OBJECT,ID_NATURE_OBJECT_LINK,ID_REPORT_TYPE,ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_ID_NATURE_OBJECT_LINK (ID_NATURE_OBJECT_LINK),
  KEY IDX_ID_REPORT_ATTRIBUTES (ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_REPORT_TYPE (ID_REPORT_TYPE),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_ID_NATURE_OBJECT_LINK_NATUR (ID_NATURE_OBJECT_LINK,ID_NATURE_OBJECT),
  KEY IDX_ID_NATURE_OBJECT_NATURE_LIN (ID_NATURE_OBJECT,ID_NATURE_OBJECT_LINK),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-57">
        <sql>CREATE TABLE chm62edt_population (
  ID_POPULATION varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_POPULATION),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-58">
        <sql>CREATE TABLE chm62edt_population_unit (
  ID_POPULATION_UNIT int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_POPULATION_UNIT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-59">
        <sql>CREATE TABLE chm62edt_region_codes (
  ID_REGION_CODE varchar(16) NOT NULL default '0',
  NAME varchar(255) NOT NULL default '''''',
  DESCRIPTION text,
  PRIMARY KEY  (ID_REGION_CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-60">
        <sql>CREATE TABLE chm62edt_relative_surface (
  ID_RELATIVE_SURFACE varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_RELATIVE_SURFACE),
  UNIQUE KEY IDX_ID_RELATIVE_SURFACE (ID_RELATIVE_SURFACE),
  UNIQUE KEY NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-61">
        <sql>CREATE TABLE chm62edt_report_attributes (
  ID_REPORT_ATTRIBUTES int(11) NOT NULL default '0',
  NAME varchar(64) NOT NULL default '''''',
  TYPE varchar(16) default NULL,
  VALUE text,
  PRIMARY KEY  (ID_REPORT_ATTRIBUTES,NAME),
  KEY IDX_NAME (NAME),
  KEY IDX_NAME_ATTRIBUTES (NAME,ID_REPORT_ATTRIBUTES),
  KEY IDX_VALUE (VALUE(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-62">
        <sql>CREATE TABLE chm62edt_report_type (
  ID_REPORT_TYPE int(11) NOT NULL default '0',
  ID_LOOKUP varchar(50) NOT NULL default '-1',
  LOOKUP_TYPE enum('ABUNDANCE','ALTITUDE','CHEMISTRY','CLIMATE','CONSERVATION_STATUS','COVER','DEPTH','DISTRIBUTION_STATUS','EXPOSURE','FREQUENCIES','GEOMORPH','GRID','HUMAN_ACTIVITY','HUMIDITY','IMPACT','INFO_QUALITY','LANGUAGE','LEGAL_STATUS','LIFE_FORM','LIGHT_INTENSITY','POPULATION_UNIT','REGION_CODE','SALINITY','SPATIAL','SPECIES_RICHNESS','SPECIES_STATUS','SUBSTRATE','TEMPERATURE','TEMPORAL','TREND','USAGE','WATER') NOT NULL,
  PRIMARY KEY  (ID_REPORT_TYPE,ID_LOOKUP,LOOKUP_TYPE),
  KEY IDX_LOOKUP_TYPE (LOOKUP_TYPE),
  KEY IDX_ID_LOOKUP (ID_LOOKUP)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-63">
        <sql>CREATE TABLE chm62edt_reports (
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  ID_DC int(11) NOT NULL default '-1',
  ID_GEOSCOPE int(11) NOT NULL default '-1',
  ID_GEOSCOPE_LINK int(11) NOT NULL default '-1',
  ID_REPORT_TYPE int(11) NOT NULL default '-1',
  ID_REPORT_ATTRIBUTES int(11) NOT NULL default '-1',
  PRIMARY KEY  (ID_NATURE_OBJECT,ID_DC,ID_GEOSCOPE,ID_GEOSCOPE_LINK,ID_REPORT_TYPE,ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_ID_GEOSCOPE (ID_GEOSCOPE),
  KEY IDX_ID_GEOSCOPE_LINK (ID_GEOSCOPE_LINK),
  KEY IDX_ID_REPORT_ATTRIBUTES (ID_REPORT_ATTRIBUTES),
  KEY IDX_ID_REPORT_TYPE (ID_REPORT_TYPE),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_NATURE_OBJECT_TYPE (ID_NATURE_OBJECT,ID_REPORT_TYPE),
  KEY IDX_ID_REPORT_TYPE_NATURE_OBJEC (ID_REPORT_TYPE,ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-64">
        <sql>CREATE TABLE chm62edt_representativity (
  ID_REPRESENTATIVITY varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_REPRESENTATIVITY),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-65">
        <sql>CREATE TABLE chm62edt_representativity_code (
  ID_REPRESENTATIVITY varchar(8) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION varchar(255) default NULL,
  PRIMARY KEY  (ID_REPRESENTATIVITY),
  UNIQUE KEY IDX_NAME (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-66">
        <sql>CREATE TABLE chm62edt_salinity (
  ID_SALINITY int(11) NOT NULL default '0',
  NAME varchar(128) NOT NULL default '''''',
  DESCRIPTION text,
  OLD_CODE varchar(16) default NULL,
  USED int(11) default NULL,
  PRIMARY KEY  (ID_SALINITY)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-67">
        <sql>CREATE TABLE chm62edt_site_attributes (
  ID_SITE varchar(16) NOT NULL default '''''',
  NAME varchar(128) NOT NULL default '''''',
  TYPE varchar(16) NOT NULL default '''''',
  VALUE longtext NOT NULL,
  SOURCE_TABLE varchar(32) default NULL,
  SOURCE_DB varchar(32) NOT NULL default '''''',
  PRIMARY KEY  (ID_SITE,NAME,SOURCE_DB),
  KEY IDX_ID_SITE (ID_SITE),
  KEY IDX_TYPE (TYPE),
  KEY IDX_NAME (NAME),
  KEY IDX_ID_SITE_NAME (ID_SITE,NAME),
  KEY IDX_SOURCE_TABLE (SOURCE_TABLE),
  KEY IDX_SOURCE_DB (SOURCE_DB),
  KEY IDX_VALUE (VALUE(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-68">
        <sql>CREATE TABLE chm62edt_sites (
  ID_SITE varchar(16) NOT NULL default '0',
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  ID_DESIGNATION varchar(16) default NULL,
  ID_GEOSCOPE int(11) default NULL,
  RESPONDENT text,
  NAME varchar(255) NOT NULL default '''''',
  MANAGER text,
  COMPLEX_NAME text,
  DISTRICT_NAME text,
  OWNERSHIP text,
  HISTORY text,
  `CHARACTER` text,
  DESCRIPTION text,
  MANAGEMENT_PLAN text,
  IUCNAT text,
  DESIGNATION_DATE varchar(50) default NULL,
  COMPILATION_DATE varchar(50) NOT NULL default '',
  PROPOSED_DATE varchar(50) default NULL,
  CONFIRMED_DATE varchar(50) default NULL,
  UPDATE_DATE varchar(50) default NULL,
  SPA_DATE varchar(50) default NULL,
  SAC_DATE varchar(50) default NULL,
  NATIONAL_CODE text,
  NATURA_2000 text,
  NUTS varchar(50) default NULL,
  AREA decimal(18,9) default NULL,
  LENGTH decimal(18,9) default NULL,
  LONG_EW char(1) default NULL,
  LONG_DEG int(11) default NULL,
  LONG_MIN int(11) default NULL,
  LONG_SEC int(11) default NULL,
  LAT_NS char(1) default NULL,
  LAT_DEG int(11) default NULL,
  LAT_MIN int(11) default NULL,
  LAT_SEC int(11) default NULL,
  ALT_MEAN int(11) default NULL,
  ALT_MAX int(11) default NULL,
  ALT_MIN int(11) default NULL,
  LONGITUDE decimal(18,9) default NULL,
  LATITUDE decimal(18,9) default NULL,
  CATEGORY varchar(8) default NULL,
  SOURCE_DB varchar(32) NOT NULL default '''''',
  PRIMARY KEY  (ID_SITE),
  UNIQUE KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_NAME (NAME),
  KEY IDX_ALT_MIN (ALT_MIN),
  KEY IDX_ALT_MAX (ALT_MAX),
  KEY IDX_ALT_MEAN (ALT_MEAN),
  KEY IDX_LATITUDE (LATITUDE),
  KEY IDX_LONGITUDE (LONGITUDE),
  KEY IDX_AREA (AREA),
  KEY IDX_LENGTH (LENGTH),
  KEY IDX_LONG_DEG (LONG_DEG),
  KEY IDX_LONG_MIN (LONG_MIN),
  KEY IDX_LONG_SEC (LONG_SEC),
  KEY IDX_LAT_DEG (LAT_DEG),
  KEY IDX_LAT_MIN (LAT_MIN),
  KEY IDX_LAT_SEC (LAT_SEC),
  KEY IDX_LAT_NS (LAT_NS),
  KEY IDX_LONG_EW (LONG_EW),
  KEY IDX_DESIGNATION_DATE (DESIGNATION_DATE),
  KEY IDX_SOURCE_DB (SOURCE_DB),
  CONSTRAINT chm62edt_sites_ibfk_1 FOREIGN KEY (ID_NATURE_OBJECT) REFERENCES chm62edt_nature_object (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-69">
        <sql>CREATE TABLE chm62edt_sites_related_designations (
  ID_SITE varchar(16) NOT NULL default '''''',
  ID_DESIGNATION varchar(16) NOT NULL default '''''',
  ID_GEOSCOPE int(11) NOT NULL default '0',
  SEQUENCE smallint(6) NOT NULL default '0',
  OVERLAP_TYPE varchar(16) default NULL,
  OVERLAP varchar(50) default NULL,
  DESIGNATED_SITE varchar(255) default NULL,
  DESIGNATION_DATE varchar(16) default NULL,
  SOURCE_DB varchar(32) NOT NULL default '''''',
  SOURCE_TABLE varchar(16) default NULL,
  PRIMARY KEY  (ID_SITE,ID_DESIGNATION,SEQUENCE,ID_GEOSCOPE,SOURCE_DB),
  KEY IDX_ID_DESIGNATION (ID_DESIGNATION),
  KEY IDX_ID_SITE (ID_SITE),
  KEY IDX_ISO_3L (ID_GEOSCOPE),
  KEY IDX_SOURCE_DB (SOURCE_DB),
  KEY IDX_SEQUENCE (SEQUENCE),
  KEY IDX_ID_DESIGNATION_ID_SITE (ID_DESIGNATION,ID_SITE),
  KEY IDX_SOURCE_TABLE (SOURCE_TABLE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-70">
        <sql>CREATE TABLE chm62edt_sites_sites (
  ID_SITE varchar(16) NOT NULL default '''''',
  ID_SITE_LINK varchar(16) NOT NULL default '''''',
  SEQUENCE int(11) NOT NULL default '0',
  RELATION_TYPE varchar(32) default NULL,
  OVERLAP decimal(15,10) default NULL,
  WITHIN_PROJECT int(11) default NULL,
  SOURCE_TABLE varchar(16) default NULL,
  PRIMARY KEY  (ID_SITE,ID_SITE_LINK,SEQUENCE),
  KEY IDX_ID_SITE_ID_SITE_LINK (ID_SITE,ID_SITE_LINK),
  KEY IDX_ID_SITE_LINK_ID_SITE (ID_SITE_LINK,ID_SITE),
  KEY IDX_ID_SITE (ID_SITE),
  KEY IDX_SOURCE_TABLE (SOURCE_TABLE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-71">
        <sql>CREATE TABLE chm62edt_soundex (
  NAME varchar(32) NOT NULL default '',
  PHONETIC varchar(16) NOT NULL default '',
  OBJECT_TYPE varchar(16) NOT NULL default '',
  PRIMARY KEY  (NAME),
  UNIQUE KEY IDX_NAME (NAME),
  KEY IDX_OBJECT_TYPE (OBJECT_TYPE),
  KEY IDX_PHONETIC (PHONETIC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-72">
        <sql>CREATE TABLE chm62edt_spatial (
  ID_SPATIAL int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_SPATIAL)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-73">
        <sql>CREATE TABLE chm62edt_species (
  ID_SPECIES int(11) NOT NULL default '0',
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  SCIENTIFIC_NAME varchar(100) NOT NULL default '''''',
  VALID_NAME int(11) default NULL,
  ID_SPECIES_LINK int(11) default NULL,
  TYPE_RELATED_SPECIES varchar(32) default NULL,
  TEMPORARY_SELECT int(11) default NULL,
  GENUS varchar(64) default NULL,
  SPECIES_MAP varchar(7) default NULL,
  ID_GROUP_SPECIES int(11) NOT NULL default '0',
  ID_TAXONOMY int(11) default NULL,
  AUTHOR varchar(255) default NULL,
  IGNORE_ON_MATCH tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (ID_SPECIES),
  UNIQUE KEY IDX_ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY IDX_ID_GROUP_SPECIES (ID_GROUP_SPECIES),
  KEY IDX_ID_SPECIES_LINK (ID_SPECIES_LINK),
  KEY IDX_VALID_NAME (VALID_NAME),
  KEY IDX_ID_TAXONOMY (ID_TAXONOMY),
  KEY IDX_SCIENTIFIC_NAME (SCIENTIFIC_NAME),
  KEY IDX_TYPE_RELATED_SPECIES (TYPE_RELATED_SPECIES),
  KEY GENUS (GENUS),
  CONSTRAINT chm62edt_species_ibfk_1 FOREIGN KEY (ID_NATURE_OBJECT) REFERENCES chm62edt_nature_object (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-74">
        <sql>CREATE TABLE chm62edt_species_richness (
  ID_SPECIES_RICHNESS int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_SPECIES_RICHNESS)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-75">
        <sql>CREATE TABLE chm62edt_species_statistics_module (
  AREA_NAME_EN varchar(255) NOT NULL default '''''',
  NUMBER_OF_DISTINCT_SPECIES varchar(255) default NULL,
  NUMBER_OF_SPECIES_NAMES varchar(255) default '0',
  NUMBER_OF_VERNACULAR_NAMES varchar(255) default '0',
  NUMBER_OF_LANGUAGES varchar(255) default NULL,
  NUMBER_OF_LEGAL_STATUS varchar(255) default NULL,
  NUMBER_OF_LEGAL_INSTRUMENTS varchar(255) default NULL,
  NUMBER_OF_INTERN_CONS_STATUS varchar(255) default NULL,
  NUMBER_OF_NATIONAL_CONS_STATUS varchar(255) default NULL,
  NUMBER_OF_COUNTRIES_FOR_CONS_STATUS varchar(255) default NULL,
  NUMBER_OF_GEOGRAPHICAL_DIST varchar(255) default NULL,
  NUMBER_OF_GRID_DISTR varchar(255) default NULL,
  PRIMARY KEY  (AREA_NAME_EN),
  KEY IDX_AREA_NAME_EN (AREA_NAME_EN)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-76">
        <sql>CREATE TABLE chm62edt_species_status (
  ID_SPECIES_STATUS int(11) NOT NULL default '0',
  DESCRIPTION varchar(255) NOT NULL default '''''',
  SHORT_DEFINITION varchar(255) default NULL,
  STATUS_CODE varchar(3) default NULL,
  PRIMARY KEY  (ID_SPECIES_STATUS)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-77">
        <sql>CREATE TABLE chm62edt_substrate (
  ID_SUBSTRATE int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_SUBSTRATE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-78">
        <sql>CREATE TABLE chm62edt_syntaxa (
  ID_SYNTAXA int(11) NOT NULL default '0',
  CODE varchar(8) NOT NULL default '''''',
  NAME varchar(255) NOT NULL default '''''',
  AUTHOR varchar(100) default NULL,
  SYNTAXON int(11) default NULL,
  PRIMARY KEY  (ID_SYNTAXA),
  KEY IDX_CODE (CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-79">
        <sql>CREATE TABLE chm62edt_syntaxa_source (
  ID_SYNTAXA_SOURCE char(1) NOT NULL default '''',
  SOURCE varchar(255) default NULL,
  SOURCE_ABBREV varchar(50) default NULL,
  ID_DC int(11) default '-1',
  PRIMARY KEY  (ID_SYNTAXA_SOURCE),
  KEY IDX_ID_DC (ID_DC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-80">
        <sql>CREATE TABLE chm62edt_tab_page_habitats (
  ID_NATURE_OBJECT int(11) NOT NULL default '0',
  GENERAL_INFORMATION char(1) NOT NULL default 'Y',
  GEOGRAPHICAL_DISTRIBUTION char(1) NOT NULL default 'N',
  LEGAL_INSTRUMENTS char(1) NOT NULL default 'N',
  SPECIES char(1) NOT NULL default 'N',
  HABITATS char(1) NOT NULL default 'N',
  SITES char(1) NOT NULL default 'N',
  OTHER char(1) NOT NULL default 'N',
  LINKEDDATA char(1) NOT NULL default 'N',
  CONSERVATION_STATUS char(1) NOT NULL default 'N',
  PRIMARY KEY  (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-81">
        <sql>CREATE TABLE chm62edt_tab_page_sites (
  ID_NATURE_OBJECT int(11) NOT NULL default '0',
  GENERAL_INFORMATION char(1) NOT NULL default 'Y',
  FAUNA_FLORA char(1) NOT NULL default 'N',
  DESIGNATION char(1) NOT NULL default 'N',
  HABITATS char(1) NOT NULL default 'N',
  SITES char(1) NOT NULL default 'N',
  OTHER char(1) NOT NULL default 'N',
  PRIMARY KEY  (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-82">
        <sql>CREATE TABLE chm62edt_tab_page_species (
  ID_NATURE_OBJECT int(11) NOT NULL default '0',
  GENERAL_INFORMATION char(1) NOT NULL default 'Y',
  VERNACULAR_NAMES char(1) NOT NULL default 'N',
  GEOGRAPHICAL_DISTRIBUTION char(1) NOT NULL default 'N',
  POPULATION char(1) NOT NULL default 'N',
  TRENDS char(1) NOT NULL default 'N',
  `REFERENCES` char(1) NOT NULL default 'N',
  GRID_DISTRIBUTION char(1) NOT NULL default 'N',
  THREAT_STATUS char(1) NOT NULL default 'N',
  LEGAL_INSTRUMENTS char(1) NOT NULL default 'N',
  HABITATS char(1) NOT NULL default 'N',
  SITES char(1) NOT NULL default 'N',
  GBIF char(1) default 'N',
  LINKEDDATA char(1) NOT NULL default 'N',
  CONSERVATION_STATUS char(1) default 'N',
  PRIMARY KEY  (ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-83">
        <sql>CREATE TABLE chm62edt_taxonomy (
  ID_TAXONOMY int(11) NOT NULL,
  LEVEL varchar(16) default NULL,
  NAME varchar(45) default NULL,
  `GROUP` varchar(8) default NULL,
  ID_TAXONOMY_LINK int(11) default NULL,
  ID_TAXONOMY_PARENT int(11) default NULL,
  ID_DC int(11) default NULL,
  NOTES varchar(255) default NULL,
  TAXONOMY_TREE text,
  pesimatch int(11) default '0',
  PRIMARY KEY  (ID_TAXONOMY),
  UNIQUE KEY ensureunique (LEVEL,NAME,ID_TAXONOMY_PARENT),
  KEY IDX_GROUP (`GROUP`),
  KEY IDX_NAME (NAME),
  KEY IDX_ID_DC (ID_DC),
  KEY IDX_ID_TAXONOMY_LINK (ID_TAXONOMY_LINK),
  KEY IDX_LEVEL (LEVEL),
  KEY ID_TAXONOMY_PARENT (ID_TAXONOMY_PARENT),
  KEY TAXONOMY_TREE (TAXONOMY_TREE(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-84">
        <sql>CREATE TABLE chm62edt_temperature (
  ID_TEMPERATURE int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_TEMPERATURE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-85">
        <sql>CREATE TABLE chm62edt_temporal (
  ID_TEMPORAL int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  USED int(11) default NULL,
  PRIMARY KEY  (ID_TEMPORAL)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-86">
        <sql>CREATE TABLE chm62edt_trend (
  ID_TREND int(11) NOT NULL default '0',
  STATUS varchar(50) NOT NULL default '''''',
  DESCRIPTION text,
  PRIMARY KEY  (ID_TREND)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-87">
        <sql>CREATE TABLE chm62edt_usage (
  ID_USAGE int(11) NOT NULL default '0',
  NAME varchar(64) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_USAGE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-88">
        <sql>CREATE TABLE chm62edt_water (
  ID_WATER int(11) NOT NULL default '0',
  NAME varchar(128) default NULL,
  DESCRIPTION text,
  PRIMARY KEY  (ID_WATER)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-89">
        <sql>CREATE TABLE dc_attribute_labels (
  NAME varchar(100) NOT NULL,
  LABEL varchar(100) default NULL,
  PRIMARY KEY  (NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-90">
        <sql>CREATE TABLE dc_attributes (
  ID_DC int(11) NOT NULL,
  NAME varchar(100) NOT NULL,
  OBJECT text character set latin1 NOT NULL,
  OBJECTLANG varchar(10) character set latin1 NOT NULL,
  TYPE enum('reference','','string','integer','decimal','boolean','dateTime','date') character set latin1 default NULL,
  PRIMARY KEY  (ID_DC,NAME(1),OBJECT(100),OBJECTLANG),
  UNIQUE KEY ID_DC (ID_DC,NAME,OBJECT(155)),
  KEY NAME (NAME),
  CONSTRAINT dc_attributes_ibfk_1 FOREIGN KEY (NAME) REFERENCES dc_attribute_labels (NAME) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-91">
        <sql>CREATE TABLE dc_index (
  ID_DC int(11) NOT NULL,
  COMMENT varchar(255) default NULL COMMENT 'Name of the table  from where derive ID_DC',
  REFCD int(11) default NULL COMMENT 'Identifier of the original information source id',
  REFERENCE int(11) default NULL COMMENT 'Link to legal reference',
  SOURCE text,
  EDITOR varchar(255) default NULL,
  JOURNAL_TITLE varchar(255) default NULL,
  BOOK_TITLE varchar(255) default NULL,
  JOURNAL_ISSUE varchar(50) default NULL,
  ISBN varchar(20) default NULL,
  URL varchar(255) default NULL,
  CREATED year(4) default NULL,
  TITLE varchar(255) default NULL,
  ALTERNATIVE varchar(255) default NULL,
  PUBLISHER text,
  PRIMARY KEY  (ID_DC),
  KEY IDX_REFCD (REFCD),
  KEY IDX_REFERENCE (REFERENCE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-92">
        <sql>CREATE TABLE eunis_advanced_search (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  NODE_TYPE varchar(16) NOT NULL default '',
  KEY IDX_EUNIS_ADVANCED_SEARCH (ID_SESSION,NATURE_OBJECT,ID_NODE,NODE_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-93">
        <sql>CREATE TABLE eunis_advanced_search_criteria (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  ATTRIBUTE varchar(32) NOT NULL default '',
  OPERATOR varchar(16) NOT NULL default '',
  FIRST_VALUE varchar(128) NOT NULL default '',
  LAST_VALUE varchar(128) default NULL,
  KEY IDX_EUNIS_ADVANCED_SEARCH_CRIT (ID_SESSION,NATURE_OBJECT,ID_NODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-94">
        <sql>CREATE TABLE eunis_advanced_search_criteria_temp (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  ATTRIBUTE varchar(32) NOT NULL default '',
  OPERATOR varchar(16) NOT NULL default '',
  FIRST_VALUE varchar(128) NOT NULL default '',
  LAST_VALUE varchar(128) default NULL,
  KEY IDX_EUNIS_ADV_SEARCH_CRIT_TEMP (ID_SESSION,NATURE_OBJECT,ID_NODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-95">
        <sql>CREATE TABLE eunis_advanced_search_results (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(32) NOT NULL default '',
  ID_NATURE_OBJECT int(16) NOT NULL default '0',
  PRIMARY KEY  (ID_SESSION,NATURE_OBJECT,ID_NATURE_OBJECT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-96">
        <sql>CREATE TABLE eunis_advanced_search_temp (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  NODE_TYPE varchar(16) NOT NULL default '',
  KEY IDX_EUNIS_ADVANCED_SEARCH_TEMP (ID_SESSION,NATURE_OBJECT,ID_NODE,NODE_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-97">
        <sql>CREATE TABLE eunis_bookmarks (
  USERNAME varchar(100) NOT NULL default '',
  BOOKMARK text NOT NULL,
  DESCRIPTION varchar(255) NOT NULL default '',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  PRIMARY KEY  (USERNAME,BOOKMARK(255),DESCRIPTION),
  UNIQUE KEY IDX_UNIQUE (DESCRIPTION,BOOKMARK(255),USERNAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-98">
        <sql>CREATE TABLE eunis_combined_search (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  NODE_TYPE varchar(16) NOT NULL default '',
  KEY IDX_EUNIS_COMBINED_SEARCH (ID_SESSION,NATURE_OBJECT,ID_NODE,NODE_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-99">
        <sql>CREATE TABLE eunis_combined_search_criteria (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  ATTRIBUTE varchar(32) NOT NULL default '',
  OPERATOR varchar(16) NOT NULL default '',
  FIRST_VALUE varchar(128) NOT NULL default '',
  LAST_VALUE varchar(128) default NULL,
  KEY IDX_EUNIS_COMBINED_SEARCH_CRIT (ID_SESSION,NATURE_OBJECT,ID_NODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-100">
        <sql>CREATE TABLE eunis_combined_search_criteria_temp (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  ATTRIBUTE varchar(32) NOT NULL default '',
  OPERATOR varchar(16) NOT NULL default '',
  FIRST_VALUE varchar(128) NOT NULL default '',
  LAST_VALUE varchar(128) default NULL,
  KEY IDX_EUNIS_COMB_SEARCH_CRIT_TEMP (ID_SESSION,NATURE_OBJECT,ID_NODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-101">
        <sql>CREATE TABLE eunis_combined_search_results (
  ID_SESSION varchar(64) NOT NULL default '',
  ID_NATURE_OBJECT_SPECIES int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_HABITATS int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_SITES int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_COMBINATION_1 int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_COMBINATION_2 int(11) NOT NULL default '-1',
  ID_NATURE_OBJECT_COMBINATION_3 int(11) NOT NULL default '-1',
  KEY ID_SESSION (ID_SESSION),
  KEY ID_NATURE_OBJECT_SPECIES (ID_NATURE_OBJECT_SPECIES),
  KEY ID_NATURE_OBJECT_HABITATS (ID_NATURE_OBJECT_HABITATS),
  KEY ID_NATURE_OBJECT_SITES (ID_NATURE_OBJECT_SITES),
  KEY ID_NATURE_OBJECT (ID_NATURE_OBJECT),
  KEY ID_NATURE_OBJECT_COMBINATION_1 (ID_NATURE_OBJECT_COMBINATION_1),
  KEY ID_NATURE_OBJECT_COMBINATION_2 (ID_NATURE_OBJECT_COMBINATION_2),
  KEY ID_NATURE_OBJECT_COMBINATION_3 (ID_NATURE_OBJECT_COMBINATION_3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-102">
        <sql>CREATE TABLE eunis_combined_search_temp (
  ID_SESSION varchar(64) NOT NULL default '',
  NATURE_OBJECT varchar(16) NOT NULL default '',
  ID_NODE varchar(16) NOT NULL default '',
  NODE_TYPE varchar(16) NOT NULL default '',
  KEY IDX_EUNIS_COMBINED_SEARCH_TEMP (ID_SESSION,NATURE_OBJECT,ID_NODE,NODE_TYPE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-103">
        <sql>CREATE TABLE eunis_feedback (
  ID_FEEDBACK int(11) NOT NULL,
  FEEDBACK_TYPE varchar(32) default NULL,
  MODULE varchar(32) default NULL,
  COMMENT varchar(255) default NULL,
  NAME varchar(64) default NULL,
  EMAIL varchar(64) default NULL,
  COMPANY varchar(64) default NULL,
  ADDRESS varchar(255) default NULL,
  PHONE varchar(32) default NULL,
  FAX varchar(32) default NULL,
  URL varchar(128) default NULL,
  PRIMARY KEY  (ID_FEEDBACK)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-104">
        <sql>CREATE TABLE eunis_group_search (
  CRITERIA_NAME varchar(128) NOT NULL default '',
  DESCRIPTION text,
  USERNAME varchar(100) NOT NULL default '',
  FROM_WHERE varchar(255) NOT NULL default '0',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (CRITERIA_NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-105">
        <sql>CREATE TABLE eunis_group_search_criteria (
  CRITERIA_NAME varchar(128) NOT NULL default '',
  ID_EUNIS_GROUP_SEARCH_CRITERIA varchar(16) NOT NULL default '0',
  CRITERIA_ATTRIBUTE varchar(128) NOT NULL default '',
  CRITERIA_FORM_FIELD_ATTRIBUTE varchar(128) NOT NULL default '',
  CRITERIA_OPERATOR varchar(16) NOT NULL default '',
  CRITERIA_FORM_FIELD_OPERATOR varchar(128) default NULL,
  CRITERIA_FIRST_VALUE varchar(128) NOT NULL default '',
  CRITERIA_LAST_VALUE varchar(128) default NULL,
  CRITERIA_BOOLEAN varchar(50) default NULL,
  PRIMARY KEY  (CRITERIA_NAME,ID_EUNIS_GROUP_SEARCH_CRITERIA)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-106">
        <sql>CREATE TABLE eunis_headlines (
  CONTENT varchar(255) NOT NULL default '',
  START_DATE date default NULL,
  END_DATE date default NULL,
  RECORD_DATE timestamp NOT NULL default '0000-00-00 00:00:00',
  KEY IDX_START_DATE (START_DATE),
  KEY IDX_END_DATE (END_DATE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-107">
        <sql>CREATE TABLE eunis_import_log (
  LOG_ID int(11) NOT NULL,
  MESSAGE text,
  CUR_TIMESTAMP timestamp NOT NULL default CURRENT_TIMESTAMP,
  PRIMARY KEY  (LOG_ID)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-108">
        <sql>CREATE TABLE eunis_iso_languages (
  name varchar(32) default NULL,
  code varchar(6) NOT NULL default ''
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-109">
        <sql>CREATE TABLE eunis_related_reports (
  FILE_NAME varchar(85) NOT NULL default '',
  REPORT_NAME text,
  APPROVED int(11) default NULL,
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(5) NOT NULL default 'OPERA',
  PRIMARY KEY  (FILE_NAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-110">
        <sql>CREATE TABLE eunis_rights (
  RIGHTNAME varchar(250) NOT NULL default '',
  DESCRIPTION varchar(255) default NULL,
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (RIGHTNAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-111">
        <sql>CREATE TABLE eunis_roles (
  ROLENAME varchar(64) NOT NULL default '',
  DESCRIPTION varchar(255) default NULL,
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (ROLENAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-112">
        <sql>CREATE TABLE eunis_roles_rights (
  ROLENAME varchar(64) NOT NULL default '',
  RIGHTNAME varchar(250) NOT NULL default '',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (ROLENAME,RIGHTNAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-113">
        <sql>CREATE TABLE eunis_save_advanced_search (
  CRITERIA_NAME varchar(100) default NULL,
  NATURE_OBJECT varchar(100) default NULL,
  ID_NODE int(16) NOT NULL default '0',
  NODE_TYPE varchar(16) default NULL,
  DESCRIPTION text,
  USERNAME varchar(100) default NULL,
  RECORD_AUTHOR varchar(16) NOT NULL default '',
  RECORD_DATE datetime default NULL,
  FROM_WHERE varchar(100) default NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-114">
        <sql>CREATE TABLE eunis_save_advanced_search_criteria (
  CRITERIA_NAME varchar(100) default NULL,
  NATURE_OBJECT varchar(100) default NULL,
  ID_NODE int(16) NOT NULL default '0',
  ATTRIBUTE varchar(32) default NULL,
  OPERATOR varchar(16) default NULL,
  FIRST_VALUE varchar(128) default NULL,
  LAST_VALUE varchar(128) default NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-115">
        <sql>CREATE TABLE eunis_session_log (
  ID_SESSION varchar(255) NOT NULL default '',
  USERNAME varchar(64) NOT NULL default '',
  START datetime NOT NULL default '0000-00-00 00:00:00',
  END datetime NOT NULL default '0000-00-00 00:00:00',
  IP_ADDRESS varchar(32) NOT NULL default '',
  PRIMARY KEY  (ID_SESSION,START)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-116">
        <sql>CREATE TABLE eunis_users (
  USERNAME varchar(100) NOT NULL default '',
  FIRST_NAME varchar(255) default NULL,
  LAST_NAME varchar(255) default NULL,
  EMAIL varchar(64) default NULL,
  LANG varchar(5) NOT NULL default 'en',
  THEME_INDEX int(11) unsigned NOT NULL default '0',
  LOGIN_DATE timestamp NOT NULL default '0000-00-00 00:00:00',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (USERNAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-117">
        <sql>CREATE TABLE eunis_users_roles (
  USERNAME varchar(100) NOT NULL default '',
  ROLENAME varchar(64) NOT NULL default '',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) NOT NULL default 'OPERATOR',
  PRIMARY KEY  (USERNAME,ROLENAME)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>


    <changeSet author="roug" id="rev-118">
        <sql>CREATE TABLE eunis_web_content (
  ID_PAGE varchar(64) NOT NULL default '',
  CONTENT text,
  DESCRIPTION varchar(255) default NULL,
  LANG varchar(64) NOT NULL default 'EN',
  LANG_STATUS tinyint(4) default '1',
  CONTENT_LENGTH tinyint(4) default '0',
  RECORD_DATE timestamp NOT NULL default CURRENT_TIMESTAMP,
  RECORD_AUTHOR varchar(16) default 'OPERATOR',
  CONTENT_VALID tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (ID_PAGE,LANG,RECORD_DATE),
  KEY IDX_RECORD_DATE (RECORD_DATE),
  KEY IDX_ALL_FIELDS (ID_PAGE,CONTENT(64),DESCRIPTION(64),LANG,LANG_STATUS,CONTENT_LENGTH,RECORD_DATE,RECORD_AUTHOR),
  KEY IDX_ID_PAGE (ID_PAGE),
  KEY IDX_LANG (LANG)
) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
    </changeSet>

    <changeSet author="roug" id="rev-119">
        <addForeignKeyConstraint
            constraintName="chm62edt_habitat_ibfk_1"
            baseTableName="chm62edt_habitat"
            baseColumnNames="ID_NATURE_OBJECT"
            referencedTableName="chm62edt_nature_object"
            referencedColumnNames="ID_NATURE_OBJECT"
        />
    </changeSet>
    
    <changeSet author="roug" id="rev-120" runOnChange="true">
        <!--
        <preConditions onFail="MARK_RAN">
            <dbms type="mysql"/>
            <sqlCheck expectedResult="1"><![CDATA[
    SELECT (SUBSTRING_INDEX(version(),'.',1) * 10000
    + SUBSTRING_INDEX(SUBSTRING_INDEX(version(),'.',2),'.',-1) * 100
    + SUBSTRING_INDEX(SUBSTRING_INDEX(SUBSTRING_INDEX(version(),'-',1),'.',3),'.',-1)) < 50503
    ]]></sqlCheck>
        </preConditions>
        -->
        <comment>Levenshtein algorithm implementation by Jason Rust For MySQL below 5.5.3
Downloaded from: http://www.jisaacks.com/find-similar-products-in-mysql-using-levenshtein-distance</comment>
        <sql>DROP FUNCTION IF EXISTS levenshtein</sql>
        <createProcedure><![CDATA[
CREATE FUNCTION levenshtein( s1 VARCHAR(255) CHARACTER SET utf8,
    s2 VARCHAR(255) CHARACTER SET utf8) 
  RETURNS INT 
  DETERMINISTIC 
  BEGIN 
    DECLARE s1_len, s2_len, i, j, c, c_temp, cost INT; 
    DECLARE s1_char CHAR CHARACTER SET utf8; 
    DECLARE cv0, cv1 VARBINARY(256); 
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0; 
    IF s1 = s2 THEN 
      RETURN 0; 
    ELSEIF s1_len = 0 THEN 
      RETURN s2_len; 
    ELSEIF s2_len = 0 THEN 
      RETURN s1_len; 
    ELSE 
      WHILE j <= s2_len DO 
        SET cv1 = CONCAT(cv1, UNHEX(HEX(j))), j = j + 1; 
      END WHILE; 
      WHILE i <= s1_len DO 
        SET s1_char = SUBSTRING(s1, i, 1), c = i, cv0 = UNHEX(HEX(i)), j = 1; 
        WHILE j <= s2_len DO 
          SET c = c + 1; 
          IF s1_char = SUBSTRING(s2, j, 1) THEN  
            SET cost = 0; ELSE SET cost = 1; 
          END IF; 
          SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost; 
          IF c > c_temp THEN SET c = c_temp; END IF; 
            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1; 
            IF c > c_temp THEN  
              SET c = c_temp;  
            END IF; 
            SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1; 
        END WHILE; 
        SET cv1 = cv0, i = i + 1; 
      END WHILE; 
    END IF; 
    RETURN c; 
  END
]]></createProcedure>
        <rollback>
            <sql>DROP FUNCTION IF EXISTS levenshtein</sql>
        </rollback>
    </changeSet>
    
    <changeSet author="roug" id="rev-121">
        <comment>Added ONDELETE. Necessary to be able to flush tables in any order</comment>
        <dropForeignKeyConstraint
            constraintName="chm62edt_species_ibfk_1"
            baseTableName="chm62edt_species"
        />
        <addForeignKeyConstraint
            constraintName="chm62edt_species_ibfk_1"
            baseTableName="chm62edt_species"
            baseColumnNames="ID_NATURE_OBJECT"
            referencedTableName="chm62edt_nature_object"
            referencedColumnNames="ID_NATURE_OBJECT"
            onDelete="CASCADE"
        />
        <dropForeignKeyConstraint
            constraintName="chm62edt_sites_ibfk_1"
            baseTableName="chm62edt_sites"
        />
        <addForeignKeyConstraint
            constraintName="chm62edt_sites_ibfk_1"
            baseTableName="chm62edt_sites"
            baseColumnNames="ID_NATURE_OBJECT"
            referencedTableName="chm62edt_nature_object"
            referencedColumnNames="ID_NATURE_OBJECT"
            onDelete="CASCADE"
        />
        <dropForeignKeyConstraint
            constraintName="chm62edt_habitat_ibfk_1"
            baseTableName="chm62edt_habitat"
        />
        <addForeignKeyConstraint
            constraintName="chm62edt_habitat_ibfk_1"
            baseTableName="chm62edt_habitat"
            baseColumnNames="ID_NATURE_OBJECT"
            referencedTableName="chm62edt_nature_object"
            referencedColumnNames="ID_NATURE_OBJECT"
            onDelete="CASCADE"
        />
    </changeSet>

    <changeSet author="roug" id="rev-122" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <dbms type="mysql"/>
            <sqlCheck expectedResult="1"><![CDATA[
    SELECT (SUBSTRING_INDEX(version(),'.',1) * 10000
    + SUBSTRING_INDEX(SUBSTRING_INDEX(version(),'.',2),'.',-1) * 100
    + SUBSTRING_INDEX(SUBSTRING_INDEX(SUBSTRING_INDEX(version(),'-',1),'.',3),'.',-1)) >= 50503
      ]]></sqlCheck>
        </preConditions>

        <comment>Levenshtein algorithm implementation by Jason Rust For MySQL 5.5.3 and up
Downloaded from: http://www.jisaacks.com/find-similar-products-in-mysql-using-levenshtein-distance</comment>
        <sql>DROP FUNCTION IF EXISTS levenshtein</sql>
        <createProcedure><![CDATA[
CREATE FUNCTION levenshtein( s1 VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci,
    s2 VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci ) 
  RETURNS INT 
  DETERMINISTIC 
  BEGIN 
    DECLARE s1_len, s2_len, i, j, c, c_temp, cost INT; 
    DECLARE s1_char CHAR CHARACTER SET utf8 COLLATE utf8_general_ci; 
    DECLARE cv0, cv1 VARBINARY(256); 
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0; 
    IF s1 = s2 THEN 
      RETURN 0; 
    ELSEIF s1_len = 0 THEN 
      RETURN s2_len; 
    ELSEIF s2_len = 0 THEN 
      RETURN s1_len; 
    ELSE 
      WHILE j <= s2_len DO 
        SET cv1 = CONCAT(cv1, UNHEX(HEX(j))), j = j + 1; 
      END WHILE; 
      WHILE i <= s1_len DO 
        SET s1_char = SUBSTRING(s1, i, 1), c = i, cv0 = UNHEX(HEX(i)), j = 1; 
        WHILE j <= s2_len DO 
          SET c = c + 1; 
          IF s1_char = SUBSTRING(s2, j, 1) THEN  
            SET cost = 0; ELSE SET cost = 1; 
          END IF; 
          SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost; 
          IF c > c_temp THEN SET c = c_temp; END IF; 
            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1; 
            IF c > c_temp THEN  
              SET c = c_temp;  
            END IF; 
            SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1; 
        END WHILE; 
        SET cv1 = cv0, i = i + 1; 
      END WHILE; 
    END IF; 
    RETURN c; 
  END
]]></createProcedure>
        <rollback>
            <sql>DROP FUNCTION IF EXISTS levenshtein</sql>
        </rollback>
    </changeSet>

    <changeSet author="roug" id="rev-123">
        <comment>Size of CONTENT_LENGTH has been too little since ever.</comment>
        <sql>ALTER TABLE eunis_web_content MODIFY CONTENT_LENGTH INT DEFAULT 0</sql>
    </changeSet>

    <changeSet author="roug" id="rev-124">
        <comment>Ensure that there are no duplicate filenames for the same object in the table</comment>
        <addUniqueConstraint
            tableName="chm62edt_nature_object_picture"
            constraintName="OBJECT_FILENAME"
            columnNames="ID_OBJECT, NATURE_OBJECT_TYPE, FILE_NAME"
        />
    </changeSet>
    
    <changeSet author="kaptejaa" id="rev-125">
    	<comment>Add 'localref' value to dc_attributes type enum.</comment>
		<sql>
		ALTER TABLE `dc_attributes` CHANGE COLUMN `TYPE` `TYPE` ENUM('reference','','string','integer','decimal','boolean','dateTime','date', 'localref')
		</sql>
    </changeSet>

    <changeSet author="roug" id="rev-126">
        <comment>From pre-historic times some tables have had redundant indexes on the same column. </comment>
        <dropIndex tableName="chm62edt_nature_object" indexName="ID_NATURE_OBJECT"/>
        <dropIndex tableName="chm62edt_relative_surface" indexName="IDX_ID_RELATIVE_SURFACE"/>
        <dropIndex tableName="chm62edt_soundex" indexName="IDX_NAME"/>
        <dropIndex tableName="chm62edt_species_statistics_module" indexName="IDX_AREA_NAME_EN"/>
    </changeSet>

    <changeSet author="roug" id="rev-127">
        <comment>According to http://dev.mysql.com/doc/refman/5.6/en/multiple-column-indexes.html composite indexes can also be used for just the first column. In that case many more indexes can be removed.</comment>
        <dropIndex tableName="chm62edt_biogeoregion" indexName="IDX_ID_BIOGEOREGION"/>
        <dropIndex tableName="chm62edt_country_biogeoregion" indexName="IDX_CODE_BIOGEOREGION"/>
        <dropIndex tableName="chm62edt_country_sites_factsheet" indexName="IDX_SOURCE_DB"/>
        <dropIndex tableName="chm62edt_designations" indexName="IDX_ID_DESIGNATION"/>
        <dropIndex tableName="chm62edt_geoscope" indexName="IDX_ID_GEOSCOPE"/>
        <dropIndex tableName="chm62edt_geoscope" indexName="IDX_ID_GEOSCOPE_PARENT"/>
        <dropIndex tableName="chm62edt_glossary" indexName="IDX_TERM"/>
        <dropIndex tableName="chm62edt_grid" indexName="IDX_NAME"/>
        <dropIndex tableName="chm62edt_habitat_class_code" indexName="IDX_ID_HABITAT"/>
        <dropIndex tableName="chm62edt_habitat_habitat" indexName="IDX_ID_HABITAT_LINK"/>
        <dropIndex tableName="chm62edt_habitat_habitat" indexName="IDX_ID_HABITAT"/>
        <dropIndex tableName="chm62edt_habitat_international_name" indexName="IDX_ID_HABITAT"/>
        <dropIndex tableName="chm62edt_habitat_references" indexName="IDX_ID_HABITAT"/>
        <dropIndex tableName="chm62edt_habitat_syntaxa" indexName="IDX_ID_HABITAT"/>
        <dropIndex tableName="chm62edt_nature_object_report_type" indexName="IDX_ID_NATURE_OBJECT"/>
        <dropIndex tableName="chm62edt_reports" indexName="IDX_ID_NATURE_OBJECT"/>
        <dropIndex tableName="chm62edt_site_attributes" indexName="IDX_ID_SITE"/>
        <dropIndex tableName="chm62edt_site_attributes" indexName="IDX_ID_SITE_NAME"/>
        <dropIndex tableName="chm62edt_sites_related_designations" indexName="IDX_ID_SITE"/>
        <dropIndex tableName="chm62edt_sites_sites" indexName="IDX_ID_SITE"/>
        <dropIndex tableName="eunis_web_content" indexName="IDX_ID_PAGE"/>

        <rollback>
            <createIndex tableName="chm62edt_biogeoregion" indexName="IDX_ID_BIOGEOREGION">
                <column name="ID_BIOGEOREGION" type="int"/>
            </createIndex>
            <createIndex tableName="chm62edt_country_biogeoregion" indexName="IDX_CODE_BIOGEOREGION">
                <column name="CODE_BIOGEOREGION" type="varchar(16)"/>
            </createIndex>
            <createIndex tableName="chm62edt_country_sites_factsheet" indexName="IDX_SOURCE_DB">
                <column name="SOURCE_DB" type="varchar(50)"/>
            </createIndex>
            <createIndex tableName="chm62edt_designations" indexName="IDX_ID_DESIGNATION">
                <column name="ID_DESIGNATION" type="varchar(16)"/>
            </createIndex>
            <createIndex tableName="chm62edt_geoscope" indexName="IDX_ID_GEOSCOPE">
                <column name="ID_GEOSCOPE" type="int"/>
            </createIndex>
            <createIndex tableName="chm62edt_geoscope" indexName="IDX_ID_GEOSCOPE_PARENT">
                <column name="ID_GEOSCOPE_PARENT" type="int"/>
            </createIndex>
            <createIndex tableName="chm62edt_glossary" indexName="IDX_TERM">
                <column name="TERM" type="varchar(64)"/>
            </createIndex>
            <createIndex tableName="chm62edt_grid" indexName="IDX_NAME">
                <column name="NAME" type="varchar(16)"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_class_code" indexName="IDX_ID_HABITAT">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_habitat" indexName="IDX_ID_HABITAT_LINK">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
                <column name="ID_HABITAT_LINK" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_habitat" indexName="IDX_ID_HABITAT">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_international_name" indexName="IDX_ID_HABITAT">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_references" indexName="IDX_ID_HABITAT">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_habitat_syntaxa" indexName="IDX_ID_HABITAT">
                <column name="ID_HABITAT" type="${id_habitat.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_nature_object_report_type" indexName="IDX_ID_NATURE_OBJECT">
                <column name="ID_NATURE_OBJECT" type="${id_nature_object.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_reports" indexName="IDX_ID_NATURE_OBJECT">
                <column name="ID_NATURE_OBJECT" type="${id_nature_object.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_site_attributes" indexName="IDX_ID_SITE">
                <column name="ID_SITE" type="${id_site.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_site_attributes" indexName="IDX_ID_SITE_NAME">
                <column name="ID_SITE" type="${id_site.type}"/>
                <column name="NAME" type="varchar(128)"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites_related_designations" indexName="IDX_ID_SITE">
                <column name="ID_SITE" type="${id_site.type}"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites_sites" indexName="IDX_ID_SITE">
                <column name="ID_SITE" type="${id_site.type}"/>
            </createIndex>
            <createIndex tableName="eunis_web_content" indexName="IDX_ID_PAGE">
                <column name="ID_PAGE" type="varchar(64)"/>
            </createIndex>
        </rollback>
    </changeSet>
    <changeSet id="rev-128" author="melisand">
        <comment>Removes the DMS latitude/longitude fields according to http://taskman.eionet.europa.eu/issues/17806.</comment>
        <sql>UPDATE chm62edt_sites SET LATITUDE=-(LAT_DEG+(LAT_MIN*60+LAT_SEC)/3600.000) WHERE LATITUDE IS NULL AND LAT_NS='S' AND LAT_DEG IS NOT NULL</sql>
        <sql>UPDATE chm62edt_sites SET LATITUDE=LAT_DEG+(LAT_MIN*60+LAT_SEC)/3600.000 WHERE LATITUDE IS NULL AND LAT_NS='N' AND LAT_DEG is NOT NULL</sql>
        <sql>UPDATE chm62edt_sites SET LONGITUDE=-(LONG_DEG+(LONG_MIN*60+LONG_SEC)/3600.000) WHERE LONGITUDE IS NULL AND LONG_EW='W' AND LONG_DEG IS NOT NULL</sql>
        <sql>UPDATE chm62edt_sites SET LONGITUDE=LONG_DEG+(LONG_MIN*60+LONG_SEC)/3600.000 WHERE LONGITUDE IS NULL AND LONG_EW='E' AND LONG_DEG IS NOT NULL</sql>
        <dropColumn tableName="chm62edt_sites" columnName="LAT_NS"/>
        <dropColumn tableName="chm62edt_sites" columnName="LAT_DEG"/>
        <dropColumn tableName="chm62edt_sites" columnName="LAT_MIN"/>
        <dropColumn tableName="chm62edt_sites" columnName="LAT_SEC"/>
        <dropColumn tableName="chm62edt_sites" columnName="LONG_EW"/>
        <dropColumn tableName="chm62edt_sites" columnName="LONG_DEG"/>
        <dropColumn tableName="chm62edt_sites" columnName="LONG_MIN"/>
        <dropColumn tableName="chm62edt_sites" columnName="LONG_SEC"/>
        <rollback>
            <comment>Create columns</comment>
            <addColumn tableName="chm62edt_sites">
                <column name="LAT_NS" type="char(1)" defaultValue="NULL"/>
                <column name="LAT_DEG" type="int(11)" defaultValue="NULL"/>
                <column name="LAT_MIN" type="int(11)" defaultValue="NULL"/>
                <column name="LAT_SEC" type="int(11)" defaultValue="NULL"/>
                <column name="LONG_EW" type="char(1)" defaultValue="NULL"/>
                <column name="LONG_DEG" type="int(11)" defaultValue="NULL"/>
                <column name="LONG_MIN" type="int(11)" defaultValue="NULL"/>
                <column name="LONG_SEC" type="int(11)" defaultValue="NULL"/>
            </addColumn>
            <comment>Populate columns</comment>
            <sql>UPDATE chm62edt_sites SET LAT_NS='S' where LATITUDE &lt; 0</sql>
            <sql>UPDATE chm62edt_sites SET LAT_NS='N' where LATITUDE &gt;= 0</sql>
            <sql>UPDATE chm62edt_sites SET LONG_EW='W' where LATITUDE &lt; 0</sql>
            <sql>UPDATE chm62edt_sites SET LONG_EW='E' where LATITUDE &gt;= 0</sql>
            <sql>UPDATE chm62edt_sites SET LAT_DEG=truncate(abs(latitude),0), LAT_MIN=truncate((abs(latitude)-truncate(abs(latitude),0))*60,0),
             LAT_SEC=truncate((abs(latitude)*60 - truncate(abs(latitude)*60,0))*60,0) where latitude is not null</sql>
            <sql>UPDATE chm62edt_sites SET LONG_DEG=truncate(abs(longitude),0), LONG_MIN=truncate((abs(longitude)-truncate(abs(longitude),0))*60,0),
             LONG_SEC=truncate((abs(longitude)*60 - truncate(abs(longitude)*60,0))*60,0) where longitude is not null</sql>
            <comment>Create indexes</comment>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LONG_EW">
                <column name="LONG_EW"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LONG_DEG">
                <column name="LONG_DEG"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LONG_MIN">
                <column name="LONG_MIN"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LONG_SEC">
                <column name="LONG_SEC"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LAT_NS">
                <column name="LAT_NS"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LAT_DEG">
                <column name="LAT_DEG"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LAT_MIN">
                <column name="LAT_MIN"/>
            </createIndex>
            <createIndex tableName="chm62edt_sites" indexName="IDX_LAT_SEC">
                <column name="LAT_SEC"/>
            </createIndex>
        </rollback>
    </changeSet>

    <changeSet id="rev-129" author="melisand">
        <comment>Adds Marine Area Percentage (MARINE_PERCENT) and Site Type (SITE_TYPE) columns to the Sites (chm62edt_sites) table</comment>
        <addColumn tableName="chm62edt_sites">
            <column name="MARINE_PERCENT" type="decimal(5,2)" defaultValue="NULL"/>
            <column name="SITE_TYPE" type="char(1)"/>
        </addColumn>
        <rollback>
            <dropColumn tableName="chm62edt_sites" columnName="MARINE_PERCENT"/>
            <dropColumn tableName="chm62edt_sites" columnName="SITE_TYPE"/>
        </rollback>
    </changeSet>

    <changeSet id="rev-130" author="melisand">
        <comment>Add natura 2000 code in Species table.</comment>
        <addColumn tableName="chm62edt_species">
            <column name="CODE_2000" type="varchar(10)" defaultValue="NULL"/>
        </addColumn>
        <comment>Populate the column from the old data. A select(object) should be enough if there are no bad (double) entries.</comment>
        <sql>UPDATE chm62edt_species s SET CODE_2000=(select max(object) from chm62edt_nature_object_attributes a where a.name='sameSynonymN2000' and a.id_nature_object = s.id_nature_object)</sql>

        <rollback>
            <dropColumn tableName="chm62edt_species" columnName="CODE_2000"/>
        </rollback>
    </changeSet>

    <changeSet author="roug" id="rev-128">
        <comment>Expand the code and name for new activity codes</comment>
        <modifyDataType tableName="chm62edt_natura2000_activity_code" columnName="ID_ACTIVITY_CODE" newDataType="VARCHAR(9) NOT NULL"/>
        <modifyDataType tableName="chm62edt_natura2000_activity_code" columnName="NAME" newDataType="VARCHAR(128)"/>
    </changeSet>

    <changeSet author="roug" id="rev-129" context="seedcontent">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0"><![CDATA[
    SELECT COUNT(*) FROM chm62edt_natura2000_activity_code WHERE ID_ACTIVITY_CODE LIKE "1%"
      ]]></sqlCheck>
        </preConditions>
        <comment>Load the old NATURA2000 activities</comment>
        <loadData quotchar='"' separator="," file="db/activities-old.csv" tableName="chm62edt_natura2000_activity_code">
            <column name="ID_ACTIVITY_CODE"/>
            <column name="NAME"/>
        </loadData>
    </changeSet>

    <changeSet author="roug" id="rev-130" context="seedcontent">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0"><![CDATA[
    SELECT COUNT(*) FROM chm62edt_natura2000_activity_code WHERE ID_ACTIVITY_CODE LIKE "A04%"
      ]]></sqlCheck>
        </preConditions>
        <comment>Load the new NATURA2000 activities</comment>
        <loadData quotchar='"' separator="," file="db/activities.csv" tableName="chm62edt_natura2000_activity_code">
            <column name="ID_ACTIVITY_CODE"/>
            <column name="NAME"/>
        </loadData>
    </changeSet>

    <changeSet author="roug" id="rev-131">
        <comment>Expand the TITLE to fit new annex titles</comment>
        <!-- Note: If we just set the new data type to "text", then liquibase substitutes 'LONGTEXT' -->
        <modifyDataType tableName="dc_index" columnName="TITLE" newDataType="text COMMENT 'Document title'"/>
    </changeSet>

    <changeSet id="rev-132" author="melisand" context="seedcontent">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0"><![CDATA[
        SELECT COUNT(*) FROM chm62edt_nature_object_links WHERE ID_NATURE_OBJECT='13035' and LINKTEXT='NOBANIS factsheet'
          ]]></sqlCheck>
        </preConditions>
        <comment>Adds missing NOBANIS links to some of the species. #17886</comment>
        <loadData quotchar='"' separator="," file="db/17886_nobanis_factsheets.csv" tableName="chm62edt_nature_object_links">
            <column name="ID_NATURE_OBJECT"/>
            <column name="LINK"/>
            <column name="LINKTEXT"/>
        </loadData>
    </changeSet>
    
    <changeSet id="rev-133" author="melisand">
        <comment>Adds a new column to the biogeoregion table to help with the SDF import</comment>
        <addColumn tableName="chm62edt_biogeoregion">
            <column name="CODE_SDF" type="varchar(50)" defaultValue="NULL"/>
        </addColumn>
        <sql>
            update chm62edt_biogeoregion set code_sdf='alpine' where name='Alpine';
            update chm62edt_biogeoregion set code_sdf='anatolian' where name='Anatolian';
            update chm62edt_biogeoregion set code_sdf='arctic' where name='Arctic';
            update chm62edt_biogeoregion set code_sdf='atlantic' where name='Atlantic';
            update chm62edt_biogeoregion set code_sdf='blackSea' where name='Black Sea';
            update chm62edt_biogeoregion set code_sdf='boreal' where name='Boreal';
            update chm62edt_biogeoregion set code_sdf='continental' where name='Continental';
            update chm62edt_biogeoregion set code_sdf='macaronesian' where name='Macaronesian';
            update chm62edt_biogeoregion set code_sdf='mediterranean' where name='Mediterranean';
            update chm62edt_biogeoregion set code_sdf='pannonian' where name='Pannonian';
            update chm62edt_biogeoregion set code_sdf='steppic' where name='Steppic';
            insert into chm62edt_geoscope values(289, -1, -1, 'BR');
            insert into chm62edt_geoscope values(290, -1, -1, 'BR');
            insert into chm62edt_geoscope values(291, -1, -1, 'BR');
            insert into chm62edt_geoscope values(292, -1, -1, 'BR');
            insert into chm62edt_geoscope values(293, -1, -1, 'BR');
            insert into chm62edt_biogeoregion values(13, 289, '', '', 'Marine Atlantic', 1, 'marineAtlantic');
            insert into chm62edt_biogeoregion values(14, 290, '', '', 'Marine Baltic', 1, 'marineBaltic');
            insert into chm62edt_biogeoregion values(15, 291, '', '', 'Marine Black Sea', 1, 'marineBlackSea');
            insert into chm62edt_biogeoregion values(16, 292, '', '', 'Marine Macaronesian', 1, 'marineMacaronesian');
            insert into chm62edt_biogeoregion values(17, 293, '', '', 'Marine Mediterranean', 1, 'marineMediterranean');
        </sql>
        <rollback>
            <dropColumn tableName="chm62edt_biogeoregion" columnName="CODE_SDF"/>
            <sql>
                delete from chm62edt_geoscope where id_geoscope in (289, 290, 291, 292, 293);
                delete from chm62edt_biogeoregion where id_biogeoregion in (13, 14, 15, 16, 17);
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="rev-134" author="ivascu">
        <comment>Adds a table to list the RDF files for download</comment>
        <sql>create table eunis_rdf_downloads (
                file_name varchar(100) not null,
                title varchar(100),
                comment varchar(400),
                record_date timestamp default current_timestamp,
                sort_column int,
                primary key(file_name)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8</sql>
        <rollback>
            <sql>drop table eunis_rdf_downloads</sql>
        </rollback>
    </changeSet>

    <changeSet id="rev-135" author="ivascu">
       <comment>Moves the References isPartOf/hasPart to the dc_index REFERENCE column</comment>
           <sql>update dc_index set reference=null</sql>
           <sql>update dc_index di, dc_attributes da set di.REFERENCE = cast(da.OBJECT as unsigned) where di.id_dc=da.id_dc and da.NAME = 'isPartOf'</sql>
           <sql>alter table dc_index add CONSTRAINT `ReferenceIdDc` FOREIGN KEY (`REFERENCE`) REFERENCES `dc_index` (`ID_DC`)</sql>
           <sql>alter table dc_index drop column refcd</sql>
           <rollback>
               <sql>alter table dc_index drop FOREIGN KEY `ReferenceIdDc`</sql>
               <sql>alter table dc_index add (refcd int)</sql>
           </rollback>
    </changeSet>

    <changeSet id="rev-136" author="roug">
        <comment>Remove the last bits of the glossary pages</comment>
        <dropTable tableName="chm62edt_glossary"/>
    </changeSet>

    <changeSet author="roug" id="rev-137" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <dbms type="mysql"/>
        </preConditions>

        <comment>Convenience procedure for investigation of document references. Not used in apps.</comment>
        <sql>DROP PROCEDURE IF EXISTS wherereferenced</sql>
        <createProcedure><![CDATA[
CREATE PROCEDURE wherereferenced(IN refId INT)
    READS SQL DATA
    COMMENT 'Find tables containing a reference ID'
BEGIN
        (SELECT 'chm62edt_area_legal_text' AS found FROM chm62edt_area_legal_text WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_class_code' AS found FROM chm62edt_class_code WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_conservation_status' AS found FROM chm62edt_conservation_status WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_designations' AS found FROM chm62edt_designations WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_distribution_status' AS found FROM chm62edt_distribution_status WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_geoscope' AS found FROM chm62edt_geoscope WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_grid' AS found FROM chm62edt_grid WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_group_species' AS found FROM chm62edt_group_species WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_habitat_description' AS found FROM chm62edt_habitat_description WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_habitat_references' AS found FROM chm62edt_habitat_references WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_nature_object' AS found FROM chm62edt_nature_object WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_nature_object_geoscope' AS found FROM chm62edt_nature_object_geoscope WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_nature_object_report_type' AS found FROM chm62edt_nature_object_report_type WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_report_attributes' AS found FROM chm62edt_report_attributes where NAME="ID_DC" AND VALUE = refId LIMIT 1)
  UNION (SELECT 'chm62edt_reports' AS found FROM chm62edt_reports WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_syntaxa_source' AS found FROM chm62edt_syntaxa_source WHERE ID_DC = refId LIMIT 1)
  UNION (SELECT 'chm62edt_taxonomy' AS found FROM chm62edt_taxonomy WHERE ID_DC = refId LIMIT 1)
  ;
END 
]]></createProcedure>
        <rollback>
            <sql>DROP PROCEDURE IF EXISTS wherereferenced</sql>
        </rollback>
    </changeSet>

    <changeSet id="rev-138" author="ivascu">
        <comment>Adds an index on Species table that greatly improves Sites SDF import speed</comment>
        <sql>ALTER TABLE `chm62edt_species` ADD INDEX `IDX_SPECIES_CODE_2000` (`CODE_2000`)</sql>
        <rollback>
            <sql>ALTER TABLE `chm62edt_species` DROP INDEX `IDX_SPECIES_CODE_2000`</sql>
        </rollback>
    </changeSet>

    <changeSet id="rev-139" author="ivascu">
        <comment>Moves the DC links from DC_ATTRIBUTES to a new table, DC_LINKS (#15649)</comment>
        <sql> CREATE TABLE `dc_links` (
            `ID_DC` INT(11) NOT NULL,
            `LINK` TEXT NOT NULL,
            `LINKTEXT` TEXT)
            ENGINE=InnoDB DEFAULT CHARSET=utf8
        </sql>
        <sql>insert into dc_links(id_dc, link) select id_dc, OBJECT link from dc_attributes where name='foaf:page'</sql>
        <sql>delete from dc_links where id_dc=2442</sql>
        <sql>insert into dc_links(id_dc, link) values ('2442', 'https://wcd.coe.int/ViewDoc.jsp?Ref=T-PVS/PA(2010)10&amp;Language=lanEnglish&amp;Ver=rev&amp;Site=DG4-Nature&amp;BackColorInternet=DBDCF2&amp;BackColorIntranet=FDC864&amp;BackColorLogged=FDC864')</sql>
        <sql>insert into dc_links(id_dc, link, linktext) values('2442', 'http://www.coe.int/t/dg4/cultureheritage/nature/econetworks/default_en.asp', 'Resolution No. 4 (1996) of the Bern Convention lists endangered natural habitats requiring specific conservation measures [and the designation of Areas of Special Conservation Interest (ASCIs) forming the Emerald network]')</sql>
        <sql>delete from dc_links where id_dc=2443</sql>
        <sql>insert into dc_links(id_dc, link) values ('2443', 'https://wcd.coe.int/ViewDoc.jsp?Ref=T-PVS/PA(2011)15&amp;&amp;Language=lanEnglish&amp;&amp;Ver=original&amp;&amp;Site=DG4-Nature&amp;&amp;BackColorInternet=DBDCF2&amp;&amp;BackColorIntranet=FDC864&amp;&amp;BackColorLogged=FDC864')</sql>
        <sql>insert into dc_links(id_dc, link, linktext) values('2443', 'http://www.coe.int/t/dg4/cultureheritage/nature/econetworks/default_en.asp', 'Resolution No. 6 (1998) of the Bern Convention lists the species requiring specific habitat conservation measures [and the designation of Areas of Special Conservation Interest (ASCIs) forming for the Emerald network]')</sql>

        <sql>delete from dc_attributes where name='foaf:page'</sql>
    </changeSet>

    <changeSet id="rev-140" author="ivascu">
        <comment>Drops the old (unused) Syntaxa tables (#22050)</comment>
        <dropTable tableName="chm62edt_habitat_syntaxa"/>
        <dropTable tableName="chm62edt_syntaxa"/>
        <dropTable tableName="chm62edt_syntaxa_source"/>
    </changeSet>

    <changeSet id="rev-141" author="ivascu">
        <comment>Biogeoregion code length changed (#19215)</comment>
        <modifyDataType tableName="chm62edt_biogeoregion" columnName="code_eea" newDataType="varchar(6)"/>
    </changeSet>
    <changeSet id="rev-142" author="ivascu">
        <comment>Adds tables for ecosystem data (#19215)</comment>
        <sql>
            create table chm62edt_ecosystems(
            code varchar(100),
            value varchar(100),
            maes varchar(5),
            PRIMARY KEY (code)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8
        </sql>
        <sql>
            create table chm62edt_nature_object_ecosystem (
            id_nature_object int,
            code_eco varchar(30),
            id_biogeoregion int,
            type_assoc varchar(10),
            KEY nat_obj_idx(id_nature_object)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8
        </sql>
    </changeSet>
    <changeSet id="rev-143" author="ivascu">
        <addColumn tableName="chm62edt_nature_object_ecosystem">
            <column name="season" type="char(1)" defaultValue="NULL"/>
        </addColumn>
    </changeSet>
    <changeSet id="rev-144" author="ivascu">
        <addColumn tableName="chm62edt_habitat_description">
            <column name="species" type="text" defaultValue="NULL"/>
        </addColumn>
    </changeSet>
    <changeSet id="rev-145" author="ivascu">
        <comment>Move the species list out of the habitat description</comment>
        <sql>
            update chm62edt_habitat_description set
            species=substr(description, least(
            if(locate('Plant text', description), locate('Plant text', description), 999999),
            if(locate('Invertebrate text', description), locate('Invertebrate text', description), 999999),
            if(locate('Vertebrate text', description), locate('Vertebrate text', description), 999999))),
            description=left(description, least(
            if(locate('Plant text', description), locate('Plant text', description), 999999),
            if(locate('Invertebrate text', description), locate('Invertebrate text', description), 999999),
            if(locate('Vertebrate text', description), locate('Vertebrate text', description), 999999)) -1)
            where description like '%Plant text%' or description like '%Invertebrate text%' or description like '%Vertebrate text%'
        </sql>
    </changeSet>

    <changeSet id="rev-146" author="ivascu">
        <comment>Modified the link text length to accomodate Art 12 data</comment>
        <sql>alter table chm62edt_nature_object_links modify linktext varchar(200)</sql>
    </changeSet>

    <changeSet id="rev-147" author="ivascu">
        <comment>Changes the Art 12/ Conservation links to match #82402</comment>
        <sql>
            update chm62edt_nature_object_links set linktext =
            REPLACE(linktext, 'Population status and trends 2013 - Experts web tool','Population status and trends 2008-2012 – experts web viewer')
            where linktext like '%Population status and trends 2013 - Experts web tool%';

            update chm62edt_nature_object_links set linktext =
            REPLACE(linktext, 'Conservation status 2013 - Experts web tool','Conservation status 2007-2012 - experts web viewer')
            where linktext like '%Conservation status 2013 - Experts web tool%';
        </sql>
    </changeSet>

    <changeSet id="rev-148" author="ivascu">
        <comment>Added a cache for Art 17 assessments (from sparql queries)</comment>
        <sql>
            CREATE TABLE chm62edt_art17cache (
            code2000 VARCHAR(8),
            object_type VARCHAR(2),
            region VARCHAR(100),
            code VARCHAR(10),
            assessment VARCHAR(100)
            );
        </sql>
    </changeSet>

    <changeSet id="rev-149" author="ivascu">
        <comment>Index for art17 cache</comment>
        <sql>ALTER TABLE chm62edt_art17cache ADD INDEX art17cache_idx (object_type, code2000);</sql>
    </changeSet>

    <changeSet id="rev-150" author="ivascu">
        <comment>Added habitat type column to simplify identification</comment>
        <sql>ALTER TABLE chm62edt_habitat ADD habitat_type varchar(20);</sql>
        <sql>ALTER TABLE chm62edt_habitat ADD index htype_idx(habitat_type);</sql>
        <sql>UPDATE chm62edt_habitat set habitat_type='EUNIS' where id_habitat &lt; 10000;</sql>
        <sql>UPDATE chm62edt_habitat set habitat_type='ANNEX1' where id_habitat >= 10000;</sql>
    </changeSet>

    <changeSet id="rev-151" author="ivascu">
        <comment>Added comment column to habitat classification</comment>
        <sql>alter table chm62edt_habitat_class_code add comment varchar(100);</sql>
    </changeSet>

    <changeSet id="rev-152" author="ivascu">
        <comment>Added visibility flag to pictures</comment>
        <sql>alter table chm62edt_nature_object_picture add visible numeric(2) default 1;</sql>
    </changeSet>
    <changeSet id="rev-153" author="ivascu">
        <comment>Set species picture visibility only to the allowed ones</comment>
        <sql>update chm62edt_nature_object_picture set visible=0 where nature_object_type='Species' and not(SOURCE LIKE 'Saxifraga%' OR SOURCE LIKE 'Otars%' OR SOURCE LIKE 'LIFE%' OR SOURCE LIKE 'Axel Hochkirch')</sql>
    </changeSet>

    <changeSet id="rev-154" author="ivascu">
        <comment>Added a "package" field to the pictures so we can manage the pictures better when the rights of use change</comment>
        <sql>alter table chm62edt_nature_object_picture add package varchar(20);</sql>
    </changeSet>

    <changeSet id="rev-155" author="ivascu">
        <comment>Indexed picture visible column</comment>
        <sql>ALTER TABLE chm62edt_nature_object_picture
            ADD INDEX idx_nop_visible (visible);</sql>
    </changeSet>

    <changeSet id="rev-156" author="ivascu">
        <comment>Added the id_parent column to the habitats table and populated the old habitats</comment>
        <sql>alter table chm62edt_habitat add(EEA_CODE varchar(20));
            alter table chm62edt_habitat add(ID_HABITAT_PARENT int(16));
            alter table chm62edt_habitat add index habitat_p_idx(id_habitat_parent);
            alter table chm62edt_habitat add constraint habitat_parent foreign key (id_habitat_parent) references chm62edt_habitat(id_habitat);

            update chm62edt_habitat set level=level-1 where habitat_type='EUNIS2017' and eunis_habitat_code like 'S3-6%' and length(eunis_habitat_code) > 4;

            create temporary table habitat1 as select * from chm62edt_habitat;
            alter table habitat1 add index h1i0(id_habitat);
            alter table habitat1 add index h1i1(eunis_habitat_code);
            alter table habitat1 add index h1i2(level, habitat_type);
            alter table habitat1 add index h1i3(code_2000);

            update chm62edt_habitat h1 set id_habitat_parent =
            (select id_habitat from habitat1 h2 where replace(h2.eunis_habitat_code,'-','') = left(replace(h1.eunis_habitat_code,'-',''), length(replace(h1.eunis_habitat_code,'-',''))-1) and h2.level = h1.level - 1
            and h2.habitat_type = h1.habitat_type)
            where habitat_type='EUNIS2017';

            update chm62edt_habitat h1 set id_habitat_parent =
            (select id_habitat from habitat1 h2 where replace(h2.eunis_habitat_code,'.','') = left(replace(h1.eunis_habitat_code,'.',''), length(replace(h1.eunis_habitat_code,'.',''))-1) and h2.level = h1.level - 1
            and h2.habitat_type = h1.habitat_type)
            where habitat_type='EUNIS';

            update chm62edt_habitat h1 set id_habitat_parent =
            (select id_habitat from habitat1 h2 where
            ((h1.level > 2 and h2.code_2000 = rpad( left(h1.code_2000, h1.level -1), 4, '0'))
            or
            (h1.level = 2 and h2.code_2000 = left(h1.code_2000, h1.level -1))
            or
            (h1.level = 1 and h2.id_habitat=10000)
            )
            and h2.level = h1.level - 1
            and h2.habitat_type = h1.habitat_type )
            where habitat_type='ANNEX1';

            update chm62edt_habitat set ID_HABITAT_PARENT = 5394 where eunis_habitat_code like 'X%' and id_habitat&lt;&gt;5394;
        </sql>
    </changeSet>

    <changeSet id="redlist-1" author="ivascu">
        <comment>Red List of Habitats tables</comment>
        <sql>
            CREATE TABLE `chm62edt_habitat_redlist` (
            `id_habitat` int(16) NOT NULL,
            `category_EU28` varchar(100) DEFAULT NULL,
            `category_EU28PLUS` varchar(100) DEFAULT NULL,
            `synthesis` varchar(3500) DEFAULT NULL,
            `capacity_recover` varchar(2500) DEFAULT NULL,
            `EU28_trend_quantity` varchar(100) DEFAULT NULL,
            `EU28PLUS_trend_quantity` varchar(100) DEFAULT NULL,
            `EU28_trend_quality` varchar(100) DEFAULT NULL,
            `EU28PLUS_trend_quality` varchar(100) DEFAULT NULL,
            `conservation_management` varchar(2500) DEFAULT NULL,
            `map_description` varchar(2500) DEFAULT NULL,
            `overall_criteria_EU28` varchar(100) DEFAULT NULL,
            `overall_criteria_EU28_plus` varchar(100) DEFAULT NULL,
            `confidence_assessment` varchar(100) DEFAULT NULL,
            `pressures_and_threats` varchar(3500) DEFAULT NULL,
            `occurrence_ext_EU28_EOO` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28PLUS_EOO` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28_AOO` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28PLUS_AOO` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28_area_km2` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28PLUS_area_km2` varchar(100) DEFAULT NULL,
            `occurrence_ext_EU28_comment` varchar(250) DEFAULT NULL,
            `occurrence_ext_EU28PLUS_comment` varchar(250) DEFAULT NULL,
            PRIMARY KEY (`id_habitat`),
            CONSTRAINT `habitat_id` FOREIGN KEY (`id_habitat`) REFERENCES `chm62edt_habitat` (`ID_HABITAT`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_habitat_redlist_conservation` (
            `ID_HABITAT` int(16) NOT NULL,
            `ID_MEASURE` int(11) NOT NULL
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_habitat_redlist_occurrence` (
            `id_habitat` int(16) DEFAULT NULL,
            `EU28_type` varchar(10) DEFAULT NULL,
            `id_country` int(11) DEFAULT NULL,
            `present` varchar(100) DEFAULT NULL,
            `current_area_value` varchar(20) DEFAULT NULL,
            `trend_quantity` varchar(100) DEFAULT NULL,
            `trend_quality` varchar(100) DEFAULT NULL,
            `id_sea` int(11) DEFAULT NULL,
            KEY `habitat_id_idx` (`id_habitat`),
            KEY `habitat_country_idx` (`id_country`),
            CONSTRAINT `habitat_oc_id` FOREIGN KEY (`id_habitat`) REFERENCES `chm62edt_habitat` (`ID_HABITAT`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_habitat_redlist_threats` (
            `ID_HABITAT` int(16) NOT NULL,
            `ID_THREAT` int(11) NOT NULL
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_redlist_seas` (
            `ID_SEA` int(11) NOT NULL DEFAULT 0,
            `SEA_NAME` varchar(250) NOT NULL,
            PRIMARY KEY (`ID_SEA`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_redlist_countries` (
            `ID_COUNTRY` int(11) NOT NULL DEFAULT 0,
            `COUNTRY_NAME` varchar(250) NOT NULL,
            `COUNTRY_TYPE` varchar(10) NOT NULL,
            PRIMARY KEY (`ID_COUNTRY`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_conservation_measures` (
            `ID_MEASURE` int(11) NOT NULL DEFAULT 0,
            `MAIN_CATEGORY` varchar(250) NOT NULL,
            `SUBCATEGORY` varchar(2500) NOT NULL,
            PRIMARY KEY (`ID_MEASURE`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            CREATE TABLE `chm62edt_threats` (
            `ID_THREAT` int(11) NOT NULL DEFAULT 0,
            `THREAT_CODE_1` varchar(10) DEFAULT NULL,
            `MAIN_THREAT` varchar(2500) DEFAULT NULL,
            `DESCRIPTION` varchar(2500) DEFAULT NULL,
            `sort_order` char(16) DEFAULT NULL,
            PRIMARY KEY (`ID_THREAT`),
            KEY `IDX_THREAT` (`ID_THREAT`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
        </sql>

    </changeSet>

</databaseChangeLog>
